<?xml version="1.0"?>
<fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format" font-family="serif,Symbol,ZapfDingbats" font-size="10pt" text-align="justify" line-height="normal" font-selection-strategy="character-by-character" line-height-shift-adjustment="disregard-shifts" writing-mode="lr-tb" language="en"><fo:layout-master-set><fo:simple-page-master master-name="blank" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body display-align="center" margin-bottom="0.5in" margin-top="0.5in" margin-left="0in" margin-right="0in" region-name="blank-body"/><fo:region-before region-name="xsl-region-before-blank" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-blank" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-blank" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-blank" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:page-sequence-master master-name="titlepage"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="titlepage-first" page-position="first"/><fo:conditional-page-master-reference master-reference="titlepage-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="titlepage-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="lot"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="lot-first" page-position="first"/><fo:conditional-page-master-reference master-reference="lot-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="lot-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="front"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="front-first" page-position="first"/><fo:conditional-page-master-reference master-reference="front-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="front-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="body"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="body-first" page-position="first"/><fo:conditional-page-master-reference master-reference="body-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="body-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="back"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="back-first" page-position="first"/><fo:conditional-page-master-reference master-reference="back-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="back-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="index"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="index-first" page-position="first"/><fo:conditional-page-master-reference master-reference="index-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="index-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master></fo:layout-master-set><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="1" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Cryptographie pratique</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Cryptographie pratique</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="idm45903956058576"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block start-indent="0pt" text-align="center"><fo:block keep-with-next.within-column="always" font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="center" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Cryptographie pratique</fo:block></fo:block><fo:block space-before="0.5em" font-size="14.4pt"><fo:block>Sébastien Millet <fo:inline font-family="monospace"><fo:inline keep-together.within-line="always" hyphenate="false">&lt;&lt;milletseb@laposte.net&gt;&gt;</fo:inline></fo:inline></fo:block></fo:block><fo:block space-before="0.5em"><fo:table table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell number-columns-spanned="3"><fo:block>Revision History</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell><fo:block>Revision 0.5; 0.6</fo:block></fo:table-cell><fo:table-cell><fo:block>February 29th, 2016; March 1st, 2016</fo:block></fo:table-cell><fo:table-cell><fo:block>SM</fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:block></fo:block></fo:block><fo:block id="toc...idm45903956058576" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block><fo:block><fo:block space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em" space-after="0.5em" start-indent="0pt" font-size="17.28pt" font-weight="bold" font-family="sans-serif,Symbol,ZapfDingbats">Table of Contents</fo:block></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_introduction">Introduction</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_introduction"><fo:page-number-citation ref-id="_introduction"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_le_format_x509">Le format x509</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_le_format_x509"><fo:page-number-citation ref-id="_le_format_x509"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45903956058576._le_format_x509" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_visualisation_d_8217_un_certificat_x509">Visualisation d’un certificat x509</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_visualisation_d_8217_un_certificat_x509"><fo:page-number-citation ref-id="_visualisation_d_8217_un_certificat_x509"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_structure_d_8217_un_certificat_x509">Structure d’un certificat x509</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_structure_d_8217_un_certificat_x509"><fo:page-number-citation ref-id="_structure_d_8217_un_certificat_x509"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_hi&#xE9;rarchie_des_certificats">Hiérarchie des certificats</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_hi&#xE9;rarchie_des_certificats"><fo:page-number-citation ref-id="_hi&#xE9;rarchie_des_certificats"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_v&#xE9;rification_de_signature_rsa">Vérification de signature RSA</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_v&#xE9;rification_de_signature_rsa"><fo:page-number-citation ref-id="_v&#xE9;rification_de_signature_rsa"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45903956058576._v&#xE9;rification_de_signature_rsa" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_la_signature_rsa">La signature RSA</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_la_signature_rsa"><fo:page-number-citation ref-id="_la_signature_rsa"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_v&#xE9;rification_du_certificat_de_letsencrypto_org">Vérification du certificat de letsencrypto.org</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_v&#xE9;rification_du_certificat_de_letsencrypto_org"><fo:page-number-citation ref-id="_v&#xE9;rification_du_certificat_de_letsencrypto_org"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_conclusion">Conclusion</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_conclusion"><fo:page-number-citation ref-id="_conclusion"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_bibliography">Bibliography</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_bibliography"><fo:page-number-citation ref-id="_bibliography"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block id="_introduction"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Introduction</fo:marker><fo:block font-size="20.736pt">Introduction</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cet article décrit les calculs à réaliser pour vérifier des signatures RSA et ECDSA, dans le cas des certificats x509. Ces certificats sont couramment utilisés et servent notamment à la sécurisation https.</fo:block><fo:list-block id="idm45903954012240" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951843264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">RSA</fo:inline> : ce cas sera traité avec le certificat d’un serveur https.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903954247376" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">ECDSA</fo:inline> : nous commencerons par travailler sur un certificat auto-signé que nous créerons pour l’occasion, afin de se familiariser avec les calculs qu’implique la cryptographie à courbes elliptiques. Pour finir nous récupérerons un certificat CEV (Certificat Électronique Visible). Ce dernier cas sort du cadre x509 qui est l’objet principal de cet article, le format pour un tel certificat étant 2D-Doc.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au fil du document nous ferons appel aux outils suivants :</fo:block><fo:list-block id="idm45903954742080" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903954080544" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-family="monospace">openssl</fo:inline> pour travailler sur les certificats x509 en ligne de commande
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903952207712" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-family="monospace">python</fo:inline>, <fo:inline font-family="monospace">bc</fo:inline> ou <fo:inline font-family="monospace">zsbc</fo:inline> pour faire des calculs avec des nombres entiers de grande taille
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903952988896" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Conversion entre encodage <fo:inline font-style="italic">PEM</fo:inline> et encodage <fo:inline font-style="italic">binaire</fo:inline> (Linux : <fo:inline font-family="monospace">base64</fo:inline>, Windows : <fo:inline font-family="monospace">notepad</fo:inline>++)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953624128" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Édition du contenu de fichier binaire (Linux : <fo:inline font-family="monospace">gvim/xxd</fo:inline>, Windows : <fo:inline font-family="monospace">notepad</fo:inline>++)
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903953944848" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Windows versus Linux</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ce document s’adresse aux utilisateurs de Windows et Linux.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Il peut arriver qu’entre les deux environnements l’outil ou la commande à employer soit différente. Dans ce cas la solution pour chaque système est présentée.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/></fo:block><fo:block id="_le_format_x509"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Le format x509</fo:marker><fo:block font-size="20.736pt">Le format x509</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_visualisation_d_8217_un_certificat_x509"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Visualisation d’un certificat x509</fo:marker><fo:block font-size="17.28pt">Visualisation d’un certificat x509</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">A l’aide d’un navigateur, ouvrir une page en https et afficher le certificat.
Les exemples de ce document sont réalisés avec le certificat https du site <fo:basic-link external-destination="url(https://letsencrypt.org/)"><fo:inline hyphenate="false">https://letsencrypt.org/</fo:inline></fo:basic-link>.</fo:block><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Exemple avec Firefox 44</fo:block><fo:list-block id="idm45903954103168" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903953654560" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Cliquer sur l’icône de cadenas à gauche de la barre d’adresse et cliquer sur la flèche droite (Figure 1)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953852000" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Cliquer sur <fo:inline font-style="italic">Plus d’informations</fo:inline> (Figure 2)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953503360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Cliquer sur <fo:inline font-style="italic">Afficher le certificat</fo:inline> (Figure 3)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903954684688" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>4.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Afficher l’onglet <fo:inline font-style="italic">Détails</fo:inline> et parcourir les différents champs du certificat (Figure 4, 5 et 6)
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903952040240" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 1.  </fo:block><fo:block id="idm45903953423408"><fo:external-graphic src="url(./images/img-firefox-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903952738272" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 2.  </fo:block><fo:block id="idm45903952376880"><fo:external-graphic src="url(./images/img-firefox-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903953238000" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 3.  </fo:block><fo:block id="idm45903954711968"><fo:external-graphic src="url(./images/img-firefox-3-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903954314384" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 4.  </fo:block><fo:block id="idm45903951473568"><fo:external-graphic src="url(./images/img-firefox-4-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903954102336" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 5.  </fo:block><fo:block id="idm45903954161104"><fo:external-graphic src="url(./images/img-firefox-5-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903953168544" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 6.  </fo:block><fo:block id="idm45903951688624"><fo:external-graphic src="url(./images/img-firefox-6-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous nous intéresserons à la partie supérieure (<fo:inline font-style="italic">Hiérarchie des certificats</fo:inline>) plus tard.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour le moment examinons le certificat. L’affichage de Firefox en dessous de <fo:inline font-style="italic">Champs du certificat</fo:inline> liste trois parties :</fo:block><fo:list-block id="idm45903951280720" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903954315600" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le certificat proprement dit, qui contient beaucoup d’informations structurées sur plusieurs niveaux hiérarchiques
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953585280" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L’algorithme de signature du certificat, dans notre exemple, <fo:inline font-style="italic">PKCS #1 SHA-256 avec chiffrement RSA</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951974928" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La signature du certificat, ici, une suite de 256 octets
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cette structure en trois parties est toujours respectée pour un certificat x509.
A noter qu’Internet Explorer et Chrome affichent les mêmes informations mais sans faire ressortir la structure trois parties.</fo:block></fo:block><fo:block id="_structure_d_8217_un_certificat_x509"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Structure d’un certificat x509</fo:marker><fo:block font-size="17.28pt">Structure d’un certificat x509</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Où la structure d’un certificat est-elle définie, et quelle est cette définition ?</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Une recherche sur un moteur de recherche avec les mots-clés <fo:inline font-style="italic">RFC</fo:inline> et <fo:inline font-style="italic">x509</fo:inline> produit l’URL suivante dans les premières réponses :</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:basic-link external-destination="url(https://tools.ietf.org/html/rfc5280)"><fo:inline hyphenate="false">https://tools.ietf.org/html/rfc5280</fo:inline></fo:basic-link></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Et effectivement la<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">1</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">1</fo:inline>Nous utiliserons le féminin dans ce document. RFC étant un acronyme anglais, il n’y a pas d’argument définitif pour l’emploi du masculin ou du féminin.</fo:block></fo:footnote-body></fo:footnote>
<fo:inline font-weight="bold">RFC 5280</fo:inline> définit le format x509 version 3.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Affichons-la. Dans la section <fo:inline font-style="italic">4.1</fo:inline> se trouve la définition suivante.</fo:block><fo:block id="idm45903954442736" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">...
4.1.  Basic Certificate Fields

   The X.509 v3 certificate basic syntax is as follows.  For signature
   calculation, the data that is to be signed is encoded using the ASN.1
   distinguished encoding rules (DER) [X.690].  ASN.1 DER encoding is a
   tag, length, value encoding system for each element.

Certificate  ::=  SEQUENCE  {
        tbsCertificate       TBSCertificate,
        signatureAlgorithm   AlgorithmIdentifier,
        signatureValue       BIT STRING  }
...</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La suite définit les différents éléments du certificat, à savoir ce que sont les structures <fo:inline font-style="italic">TBSCertificate</fo:inline> et <fo:inline font-style="italic">AlgorithmIdentifier</fo:inline>.</fo:block><fo:block id="idm45903953661312" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">Grammaire, ASN.1 et DER</fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La structure du certificat est décrite par une <fo:inline font-style="italic">grammaire</fo:inline>, d’après les règles de syntaxe <fo:inline font-weight="bold">ASN.1</fo:inline> (<fo:inline font-weight="bold">A</fo:inline>bstrat <fo:inline font-weight="bold">S</fo:inline>yntax <fo:inline font-weight="bold">N</fo:inline>otation number <fo:inline font-weight="bold">1</fo:inline>) <fo:basic-link internal-destination="1"><fo:inline>[1]</fo:inline></fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les différents encodages possibles du standard <fo:inline font-style="italic">ASN.1</fo:inline> sont eux-mêmes des standards et le <fo:inline font-weight="bold">X.690</fo:inline> est l’un d’entre eux <fo:basic-link internal-destination="2"><fo:inline>[2]</fo:inline></fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La RFC précise que la partie du certificat à signer doit être encodée selon le standard <fo:inline font-style="italic">Distinguished Encoding Rules</fo:inline> ou <fo:inline font-weight="bold">DER</fo:inline>. Entre autres encodages, le document X.690 définit le DER.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous verrons plus loin l’encodage DER.
Si vous souhaitez le découvrir, plutôt que d’examiner directement le document X.690, je vous recommande de commencer par l’article Wikipédia <fo:basic-link internal-destination="3"><fo:inline>[3]</fo:inline></fo:basic-link>.</fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">En ASN.1 le mot-clé <fo:inline font-style="italic">SEQUENCE</fo:inline> sans autre précision indique que la valeur est constituée d’une suite de valeurs elles-mêmes spécifiées en ASN.1. La valeur <fo:inline font-style="italic">Certificate</fo:inline> contient donc, à la suite :</fo:block><fo:list-block id="idm45903951687472" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903954460080" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur <fo:inline font-style="italic">tbsCertificate</fo:inline>, soit le certificat à signer (<fo:inline font-weight="bold">t</fo:inline>o <fo:inline font-weight="bold">b</fo:inline>e <fo:inline font-weight="bold">s</fo:inline>igned <fo:inline font-weight="bold">Certificate</fo:inline>)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953893152" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur <fo:inline font-style="italic">signatureAlgorithm</fo:inline>, soit l’identification de l’algorithme de signature
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953670752" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur <fo:inline font-style="italic">signatureValue</fo:inline>, soit la signature elle-même
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="_hi&#xE9;rarchie_des_certificats"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Hiérarchie des certificats</fo:marker><fo:block font-size="17.28pt">Hiérarchie des certificats</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans la partie tbsCertificate de <fo:inline font-style="italic">letsencrypt.org</fo:inline>, intéressons-nous à deux éléments en particulier, l'<fo:inline font-style="italic">émetteur</fo:inline> du certificat et le <fo:inline font-style="italic">sujet</fo:inline> du certificat.</fo:block><fo:list-block id="idm45903952540208" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903953004656" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le <fo:inline font-style="italic">sujet</fo:inline> du certificat a pour <fo:inline font-weight="bold">CN</fo:inline> (<fo:inline font-weight="bold">C</fo:inline>ommon <fo:inline font-weight="bold">N</fo:inline>ame) letsencrypt.org et c’est le dernier nom qui est affiché dans la hiérarchie des certificats (partie supérieure de la fenêtre).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953170064" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L'<fo:inline font-style="italic">émetteur</fo:inline> du certificat a pour CN <fo:inline font-style="italic">TrustID Server CA A52</fo:inline> et on peut voir ce nom au-dessus de letsencrypt.org dans la hiérarchie.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">L'émetteur et le sujet ont également le pays (<fo:inline font-weight="bold">C</fo:inline>) et l’organisation (<fo:inline font-weight="bold">O</fo:inline>) définis dans leur nom, ainsi que d’autres éléments.
Le "nom simple" ou "nom court" du certificat est son CN. Le standard x509 ne définit pas cette notion de "nom simple" ou "nom court", nous l’employons ici pour préciser que dans la pratique, le CN est le véritable nom du certificat, les autres éléments donnant des informations annexes.
Parfois, seul le CN est affiché pour désigner un certificat.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cela dit, le nom du certificat (au sens du standard x509) est constitué de <fo:inline font-style="italic">la totlité des éléments qui le composent</fo:inline>, et non pas seulement du CN.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le lien hiérarchique est toujours établi entre un émetteur et un sujet.
L'émetteur est celui qui signe le certificat, le sujet est celui qui est signé. Voir figures 7 et 8.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un certificat peut être à la fois émetteur (d’autres certificats sont signés par lui) et sujet (il est lui-même signé par un autre certificat), et cette chaîne forme une structure hiérarchique.
Dans notre exemple, on voit que le certificat <fo:inline font-style="italic">TrustID Server CA A52</fo:inline> est lui-même signé par <fo:inline font-style="italic">IdenTrust Commercial Root CA 1</fo:inline>.</fo:block><fo:block id="idm45903954159760" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans la pratique la situation se complique souvent avec des certificats croisés. Quoi qu’il en soit, la structure de base des liens qui relient les certificats est hiérarchique.</fo:block></fo:block></fo:block><fo:block id="idm45903951425856" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 7.  </fo:block><fo:block id="idm45903952487280"><fo:external-graphic src="url(./images/img-crt-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903951456720" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 8.  </fo:block><fo:block id="idm45903952319600"><fo:external-graphic src="url(./images/img-crt-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour signer, l'émetteur utilise sa clé privée. La vérification de la signature est faite avec sa clé publique.
Ainsi pour vérifier l’authenticité du certificat https de <fo:inline font-style="italic">letsencrypt.org</fo:inline>, nous aurons besoin de la clé publique de son émetteur, <fo:inline font-style="italic">TrustID Server CA A52</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ce principe est toujours respecté avec les certificats x509, que ce soit avec RSA ou d’autres mécanismes à clé publique / clé privée.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons maintenant passer à la vérification de la signature RSA.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/></fo:block></fo:block><fo:block id="_v&#xE9;rification_de_signature_rsa"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Vérification de signature RSA</fo:marker><fo:block font-size="20.736pt">Vérification de signature RSA</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_la_signature_rsa"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">La signature RSA</fo:marker><fo:block font-size="17.28pt">La signature RSA</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45903953237488" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">Notations</fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45903953955312" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903952064384" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur à signer (ou si l’on préfère, le <fo:inline font-style="italic">bloc de données</fo:inline> à signer) est <fo:inline font-weight="bold">tbsCertificate</fo:inline>, soit le certificat sans les informations de signature. Dans la structure en trois parties de notre certificat x509, c’est la première.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903954635392" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L’entité qui signe le certificat (l'émetteur du certificat) a pour clé RSA <fo:inline font-weight="bold">(n, e)</fo:inline> (<fo:inline font-weight="bold">n</fo:inline> est le modulo, <fo:inline font-weight="bold">e</fo:inline> est l’exposant) et <fo:inline font-weight="bold">d</fo:inline>.
Le couple <fo:inline font-weight="bold">(n, e)</fo:inline> est la clé publique, <fo:inline font-weight="bold">d</fo:inline> est la clé privée.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La page Wikipédia consacrée au système RSA <fo:basic-link internal-destination="4"><fo:inline>[4]</fo:inline></fo:basic-link> explique le lien entre <fo:inline font-style="italic">(n, e)</fo:inline> et <fo:inline font-style="italic">d</fo:inline>, et nous indique le calcul à effectuer pour <fo:inline font-style="italic">chiffrer</fo:inline>.
Pour <fo:inline font-style="italic">signer</fo:inline>, le calcul inverse le rôle de l’exposant privé et public, et pour <fo:inline font-style="italic">vérifier</fo:inline> la signature, le rôle des exposants privé et public est encore inversé (par rapport à la signature).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans notre exemple le tbsCertificate est celui de <fo:inline font-style="italic">letsencrypt.org</fo:inline>, tandis que la clé RSA (clé publique <fo:inline font-style="italic">(n, e)</fo:inline> et clé privée <fo:inline font-style="italic">d</fo:inline>) est celle de <fo:inline font-style="italic">TrustID Server CA A52</fo:inline>.</fo:block></fo:block><fo:block id="_calcul_de_la_signature"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Calcul de la signature</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45903953465120" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903953277264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L'émetteur calcule le hash (noté <fo:inline font-style="italic">M</fo:inline>) de la valeur <fo:inline font-style="italic">tbsCertificate</fo:inline> du sujet, soit <fo:inline font-style="italic">M = hash("tbsCertificate")</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951691088" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Il calcule la signature
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">2</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">2</fo:inline>On simplifie ici pour se concentrer sur les étapes importantes. En fait, le hash <fo:inline font-style="italic">M</fo:inline> calculé n’est pas signé tel quel, il subit auparavant quelques transformations comme nous le verrons plus loin.</fo:block></fo:footnote-body></fo:footnote>
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">3</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">3</fo:inline>Ce calcul est le même que pour déchiffrer un message destiné au propriétaire de la clé publique (qui est ici l'émetteur du certificat). Signer en RSA revient à chiffrer en inversant le rôle de l’exposant public et privé.</fo:block></fo:footnote-body></fo:footnote>
(notée <fo:inline font-style="italic">S</fo:inline>) avec la formule <fo:inline font-style="italic">S = M<fo:inline font-size="75%" baseline-shift="super">d</fo:inline> mod n</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="_v&#xE9;rification_de_la_signature"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Vérification de la signature</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45903954203104" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903953550928" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le vérificateur calcule <fo:inline font-style="italic">M = S<fo:inline font-size="75%" baseline-shift="super">e</fo:inline> mod n</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953160720" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Il calcule <fo:inline font-style="italic">M' = hash("tbsCertificate")</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903952479552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Si on a l'égalité <fo:inline font-style="italic">M = M'</fo:inline>, la signature est vérifiée
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block id="_v&#xE9;rification_du_certificat_de_letsencrypto_org"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Vérification du certificat de letsencrypto.org</fo:marker><fo:block font-size="17.28pt">Vérification du certificat de letsencrypto.org</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_choix_d_8217_un_programme_de_calcul"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Choix d’un programme de calcul</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous avons besoin d’une "calculatrice" qui calcule sur des nombres entiers arbitrairement grands, sans perte de précision. Dans la suite de ce document, c’est <fo:inline font-style="italic">bc</fo:inline> qui sera utilisé <fo:basic-link internal-destination="5"><fo:inline>[5]</fo:inline></fo:basic-link>.</fo:block><fo:list-block id="idm45903951813552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951487696" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Linux : <fo:inline font-style="italic">bc</fo:inline> est disponible par défaut sur la plupart des distributions.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903953239152" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Windows : les binaires sont accessibles à l’URL <fo:basic-link internal-destination="6"><fo:inline>[6]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903954299632" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Le choix de bc</fo:block><fo:block><fo:list-block id="idm45903952728624" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903953456032" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">bc</fo:inline> est installé par défaut sur la plupart des distributions Linux, et facile et rapide à installer sous Windows.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903955028944" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">bc</fo:inline> contient peu de fonctions mathématiques intégrées mais sur Internet on trouve de nombreux scripts qui permettent de l’enrichir considérablement.
</fo:block><fo:list-block id="idm45903954112352" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903952782784" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Dans <fo:inline font-style="italic">bc</fo:inline> la variable <fo:inline font-style="italic">scale</fo:inline> définit le nombre de décimales des nombres manipulés. Comme nous ne ferons que des calculs sur des entiers, nous laisserons <fo:inline font-style="italic">scale</fo:inline> à zéro (pas de partie décimale). Zéro est la valeur par défaut de <fo:inline font-style="italic">scale</fo:inline> au lancement de <fo:inline font-style="italic">bc</fo:inline>
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">4</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">4</fo:inline>Lorsque <fo:inline font-style="italic">bc</fo:inline> est lancé avec l’option <fo:inline font-weight="bold"><fo:inline font-style="normal">-l</fo:inline></fo:inline>, des fonctions mathématiques sont chargées au démarrage et <fo:inline font-style="italic">scale</fo:inline> vaut 20. Nous ne nous servirons pas de cette option dans ce document et <fo:inline font-style="italic">scale</fo:inline> sera toujours égal à zéro.</fo:block></fo:footnote-body></fo:footnote>
.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block id="idm45903953181408" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Alternatives à bc</fo:block><fo:block><fo:list-block id="idm45903953398320" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903953479552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold">sagemath</fo:inline>, logiciel mathématique en licence GPL.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903955233584" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold">python</fo:inline>, langage de programmation en licence GPL, calcule par défaut sur des entiers de taille arbitrairement grande et convient donc aux calculs que nous allons faire.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951752608" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Logiciels mathématiques propriétaires bien connus.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block id="idm45903951796048" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Table 1. Comparaison entre <fo:inline font-style="italic">bc</fo:inline> et <fo:inline font-style="italic">python</fo:inline></fo:block><fo:table border-before-width.conditionality="retain" border-collapse="collapse" border-start-style="solid" border-end-style="solid" border-top-style="solid" border-bottom-style="solid" border-start-width="0.5pt" border-end-width="0.5pt" border-top-width="0.5pt" border-bottom-width="0.5pt" border-start-color="black" border-end-color="black" border-top-color="black" border-bottom-color="black" table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(50)"/><fo:table-column column-number="2" column-width="proportional-column-width(50)"/><fo:table-header xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row keep-with-next.within-column="always"><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="center"><fo:block font-weight="bold">bc </fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="center"><fo:block font-weight="bold">python</fo:block></fo:table-cell></fo:table-row></fo:table-header><fo:table-body xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="center" number-columns-spanned="2"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Saisie d’un entier en hexadécimal</fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter au préalable</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">ibase = 2 * 8</fo:inline> <fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">ibase = 2 * 8</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">var = ABEF0E0</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">(Attention les caractères hexadécimaux doivent être en majuscule.)</fo:inline></fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Saisir l’entier précédé de <fo:inline font-style="italic">0x</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">&gt;&gt;&gt; var = 0xabef0e0</fo:inline>
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">b</fo:inline></fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="center" number-columns-spanned="2"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Affichage d’entier en hexadécimal</fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter au préalable</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">obase = 2 * 8</fo:inline>
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">obase = 2 * 8</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">2 ^ (2 ^ 4) + 1</fo:inline>
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">c</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">10001</fo:inline></fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Interpoler avec <fo:inline font-style="italic">%x</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">&gt;&gt;&gt; '%x' % (2 ** (2 ** 4) + 1)</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">'10001'</fo:inline></fo:block></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table><fo:block keep-with-previous.within-column="always"><fo:block font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" space-before="2pt" text-align="justify"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline><fo:inline font-style="italic">2 * 8</fo:inline> produit toujours 16 (décimal). Si <fo:inline font-style="italic">16</fo:inline> est lu alors qu’ibase vaut déjà 16</fo:block></fo:block><fo:block font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" space-before="2pt" text-align="justify"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">b</fo:inline><fo:inline font-style="italic">python</fo:inline> peut lire les nombres hexadécimaux indifféremment en majuscule et minuscule. <fo:inline font-style="italic">bc</fo:inline> exige des majuscules.</fo:block></fo:block><fo:block font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" space-before="2pt" text-align="justify"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">c</fo:inline>Sous Windows, <fo:inline font-style="italic">bc</fo:inline> a des difficultés à lire le caractère <fo:inline font-style="italic">circonflexe</fo:inline> au clavier (en-dessous de la touche <fo:inline font-weight="bold">9</fo:inline>). Pour contourner ce problème, il est possible d’utiliser (sur un clavier français) l’accent circonflexe à droite de la touche <fo:inline font-weight="bold">P</fo:inline>, en appuyant dessus à deux reprises. Cela affiche deux <fo:inline font-style="italic">circonflexes</fo:inline> et vous devez alors en supprimer un.</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_enregistrement_de_la_signature_sous_forme_d_8217_entier"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Enregistrement de la signature sous forme d’entier</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45903951220128" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951219152" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Depuis le navigateur, afficher la signature du certificat de <fo:inline font-style="italic">letsencrypt.org</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951218000" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sélectionner la signature et la copier-coller dans un éditeur de texte.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951217072" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer les caractère surnuméraires (enlever les <fo:inline font-style="italic">:</fo:inline> et les sauts de ligne).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951215792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>4.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Passer les caractères hexadécimaux en majuscule <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">5</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">5</fo:inline>Si vous utilisez <fo:inline font-style="italic">python</fo:inline>, il est inutile de passer les caractères hexadécimaux en majuscule.</fo:block></fo:footnote-body></fo:footnote>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951213856" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>5.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Ajouter <fo:inline font-style="italic">s=</fo:inline> devant le nombre, et ajouter une première ligne <fo:inline font-style="italic">ibase = 2 * 8</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951212208" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>6.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Enregistrer dans <fo:inline font-weight="bold"><fo:inline font-style="normal">val.b</fo:inline></fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Voir figures 9 et 10.</fo:block><fo:block id="idm45903951210176" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 9.  </fo:block><fo:block id="idm45903951209424"><fo:external-graphic src="url(./images/img-cle-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903951207520" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 10.  </fo:block><fo:block id="idm45903951206768"><fo:external-graphic src="url(./images/img-cle-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">L’instruction <fo:inline font-style="italic">ibase = 2 * 8</fo:inline> ordonne à bc de lire les nombres en hexadécimal.
<fo:inline font-style="italic">ibase = 16</fo:inline> fonctionne aussi, à condition qu’ibase soit égal à 10 (valeur par défaut) au moment d’exécuter <fo:inline font-style="italic">ibase = 16</fo:inline>.
Si ibase est déjà égal à 16 et que l’on exécute <fo:inline font-style="italic">ibase = 16</fo:inline>, une erreur se produit car bc lit 16 en hexadécimal (soit 22) et cette valeur est interdite.</fo:block><fo:block id="idm45903951202240" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:list-block id="idm45903951201984" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951201008" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Avec <fo:inline font-style="italic">bc</fo:inline> il est impératif de passer les nombres hexadécimaux en majuscule.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951199696" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">bc</fo:inline> n’accepte pas les noms de variable qui contiennent des majuscules.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le navigateur affiche l’exposant de la clé RSA (le nombre noté <fo:inline font-style="italic">e</fo:inline> tout à l’heure) sous forme décimale, alors que dans le script bc nous l’entrons en hexadécimal. Pour convertir un nombre décimal en hexadécimal, exécuter dans un terminal :</fo:block><fo:block><fo:block id="idm45903951196976" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 1. Linux</fo:block><fo:block id="idm45903951196336" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ echo "obase=16; 65537" | bc
10001</fo:block></fo:block></fo:block><fo:block><fo:block id="idm45903951195584" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 2. Windows</fo:block><fo:block id="idm45903951194944" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ echo obase=16; 65537 | bc.exe
10001</fo:block></fo:block></fo:block><fo:block id="idm45903951194096" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">Passer du texte en majuscule</fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45903951193456" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 3. Linux</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Sous Linux, on peut utiliser la ligne de commande, par exemple (nombreuses autres solutions) :</fo:block><fo:block id="idm45903951192224" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ tr '[:lower:]' '[:upper:]' &lt; fichier_entrée &gt; fichier_sortie</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un éditeur suffisamment avancé comme <fo:inline font-style="italic">vim</fo:inline> ou <fo:inline font-style="italic">emacs</fo:inline> le permet aussi.</fo:block></fo:block></fo:block><fo:block><fo:block id="idm45903951190048" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 4. Windows</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Windows ne dispose pas par défaut d’outil pour passer du texte en majuscule. Il faut installer <fo:inline font-style="italic">GNUWin32</fo:inline> ou <fo:inline font-style="italic">cygwin</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">L'éditeur de texte (natif) adéquat pour ce type de transformation est <fo:inline font-weight="bold"><fo:inline font-style="normal">notepad++</fo:inline></fo:inline>, disponible à cette URL <fo:basic-link internal-destination="7"><fo:inline>[7]</fo:inline></fo:basic-link>.</fo:block><fo:block id="idm45903951186176" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">vim</fo:inline> et <fo:inline font-style="italic">emacs</fo:inline> sont disponibles sous Windows.</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_enregistrement_de_la_cl&#xE9;_publique_sous_forme_d_8217_entier"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Enregistrement de la clé publique sous forme d’entier</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Depuis le navigateur :</fo:block><fo:list-block id="idm45903951183264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951182288" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sélectionner le certificat de <fo:inline font-style="italic">TrustID Server CA A52</fo:inline> et afficher sa clé publique.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951181136" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sélectionner la valeur de la clé publique et la copier-coller dans <fo:inline font-weight="bold"><fo:inline font-style="normal">val.b</fo:inline></fo:inline>.
Il faut le faire en deux fois, une fois pour le modulo de 256 octets (variable <fo:inline font-style="italic">n</fo:inline>) et une fois pour l’exposant (variable <fo:inline font-style="italic">e</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ne pas oublier de passer les caractères hexadécimaux en majuscule.</fo:block><fo:block id="idm45903951177840" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 11.  </fo:block><fo:block id="idm45903951177088"><fo:external-graphic src="url(./images/img-cle-3-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">A l’arrivée, <fo:inline font-weight="bold"><fo:inline font-style="normal">val.b</fo:inline></fo:inline> contient trois variables, s, n et e.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">val.b. </fo:inline>
<fo:block id="idm45903951173408" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">ibase=2*8

s=8049A7CE9627701FC4E520876B97271A8AEF34D13A5ECA776172BD7C9053DBEF9C8504E4C85629135D934D1F9C6FB09375189812B3475D5F0797F5D32BC9B11B12BC29733DCD40E57EB97BC819F21939764A4F2A270036906BAE5FD280D68DCC16428C0FCD3D213025BCFA10A6697529ED1A168E0D2CEFCB24A9C9A64C85F0BF8942B91F2CD1E92989F73EF9F2267BAB5535C3388C10C3C1D55DBC3A50A01A77CEDED612862D83A9B1A68A08B68DC35BE0F2E23E3BD9AFD4C0BA1537CFD694A5AF5D6CF8887861A9DCB89B9DE35AD3F255C251B0ECD54C2CF693DD5732EDF33939334BDB1E64C29636E0502E57914984BDA74C7E05AC948403D2BEBE051452F8

n=9769D7999885023FE9264276E8F4733FA932442690782E78579119A05D762B49F9935A5D5ACE82F3C2D8E54C367A2B1D0DDBA6A7FE91127CED7201B78CA1C5DACC9DFE09FB57E214470FE89E918F942D8032939303F5287868BA7E0F42B4317A0514225333E4A3AD6C8FAFBE636BB2329FD917B9C9E0607C99D631E1E4A0B73FAFB232AC7E8C9CDC02EBE1BC1F149CBC91F7B2FB42F3E1202BCBBF8FF3B37063FAF7752802ABC5D4B0EDEA257F87CD371496833C40021BA09E19477FF3B0CCC52560B83512F151EB17DCFC5BA5D99BEF404CD77771E9FB458B7EF2E369B042661746903ACD463DF1B0096FDCFFEE3361CAFCC72E3CED5E0AD1BF221269804B23

e=10001</fo:block>
</fo:block></fo:block><fo:block id="_la_fonction_powmod"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">La fonction powmod</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les amateurs de <fo:inline font-style="italic">python</fo:inline> ont encore un avantage à ce stade. L'équivalent de la fonction <fo:inline font-style="italic">powmod</fo:inline> y est disponible sous forme d’un troisième paramètre (facultatif) à la fonction <fo:inline font-style="italic">pow</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour ceux qui utilisent bc comme moi, il faut écrire la fonction.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La fonction <fo:inline font-style="italic">powmod</fo:inline> met en oeuvre l’algorithme d’exponentiation rapide, décrit à cette URL <fo:basic-link internal-destination="8"><fo:inline>[8]</fo:inline></fo:basic-link>.
En fait nous sommes dans un contexte modulaire et d’après Wikipédia le nom exact de l’algorithme est <fo:inline font-style="italic">exponentiation modulaire</fo:inline>. Un article y est consacrée <fo:basic-link internal-destination="9"><fo:inline>[9]</fo:inline></fo:basic-link>.
Les deux algorithmes font appel au même principe, mais le second exploite le contexte modulaire pour que les nombres manipulés n’atteignent pas une taille démesurée. C’est le second algorithme (<fo:inline font-style="italic">exponentiation modulaire</fo:inline>) dont nous avons besoin pour la suite.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Sur Internet, on peut trouver la fonction <fo:inline font-style="italic">powmod</fo:inline> dans de nombreux scripts <fo:inline font-style="italic">bc</fo:inline> à télécharger. À noter qu’elle porte parfois d’autres noms, <fo:inline font-style="italic">mpower</fo:inline> par exemple.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">powmod.b. </fo:inline>
<fo:block id="idm45903951161728" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">define powmod(a, b, c) {
        auto p, r
        p = a
        r = 1
        while (b &gt; 0) {
                if (b % 2) r = (r * p) % c
                p = (p * p) % c
                b /= 2
        }
        return r
}</fo:block>
</fo:block></fo:block><fo:block id="_calcul_de_emphasis_m_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Calcul de <fo:inline font-style="italic">M</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous voilà prêts pour calculer <fo:inline font-style="italic">M</fo:inline>.</fo:block><fo:list-block id="idm45903951158400" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951157424" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Lancer la commande suivante <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">6</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">6</fo:inline>Par défaut, <fo:inline font-style="italic">bc</fo:inline> ajoute un anti-slash après le 68e caractère et passe à la ligne suivante. On peut modifier ce comportement avec la variable d’environnement <fo:inline font-style="italic">BC_LINE_LENGTH</fo:inline>. Quand cette variable est égale à zéro, les nombres ne sont pas coupés.</fo:block></fo:footnote-body></fo:footnote> :
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903951154800" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ BC_LINE_LENGTH=0 bc powmod.b val.b</fo:block><fo:list-block id="idm45903951154176" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951152832" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Dans le shell <fo:inline font-style="italic">bc</fo:inline>, exécuter
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline> (pour que les nombres soient affichés en hexadécimal)
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903951151040" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">obase=2*8</fo:block><fo:list-block id="idm45903951150416" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951149072" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Toujours dans le shell <fo:inline font-style="italic">bc</fo:inline>, exécuter
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903951147792" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">powmod(s, e, n)</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Rappelons que c’est <fo:inline font-style="italic">S</fo:inline> (variable <fo:inline font-style="italic">s</fo:inline> dans <fo:inline font-style="italic">val.b</fo:inline>) qui doit être élevé à la puissance <fo:inline font-style="italic">e</fo:inline>, modulo <fo:inline font-style="italic">n</fo:inline>.
Lors de la définition d’obase, ibase vaut 16 (résultat du script <fo:inline font-style="italic">val.b</fo:inline> chargé au démarrage) donc obase=16 ne fonctionnerait pas.</fo:block><fo:block id="idm45903951144224" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 12.  </fo:block><fo:block id="idm45903951143472"><fo:external-graphic src="url(./images/img-powmod-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903951141568" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Important</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au démarrage de bc, ibase est égal à 16 du fait du chargement de <fo:inline font-style="italic">val.b</fo:inline>. Si vous exécutez obase = 16, obase sera égal à… 22 !
C’est logique, puisque 16 est saisi en hexadécimal. Le plus simple est d’utiliser <fo:inline font-style="italic">2 * 8</fo:inline> comme indiqué. Vous pouvez aussi exécuter <fo:inline font-style="italic">obase = 10</fo:inline> (ibase étant égal à 16), mais c’est moins clair, et vous devez être certain qu’ibase vaut bien 16 au moment d’exécuter <fo:inline font-style="italic">obase = 10</fo:inline>, pour passer l’affichage des nombres en hexadécimal
(<fo:inline font-style="italic">2 * 8</fo:inline> fonctionne toujours quelle que soit la valeur d’ibase, y compris pour les valeurs inférieures ou égales à 7).</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le résultat (figure 12) avec tous ces <fo:inline font-style="italic">F</fo:inline> prouve avec une quasi certitude que le calcul s’est bien passé.
Les <fo:inline font-style="italic">F</fo:inline> correspondent au <fo:inline font-style="italic">padding</fo:inline> standard effectué pour une signature RSA, la valeur qui suit (à partir de <fo:inline font-weight="bold"><fo:inline font-family="monospace">303130</fo:inline></fo:inline>) est le hash de tbsCertificate "emballé".</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">"Emballé", c’est-à-dire ? La valeur est spécifiée en ASN.1 et codée en DER, et elle contient d’autres informations que le seul hash de tbsCertificate.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">C’est ce que nous allons voir dans le chapitre suivant.</fo:block></fo:block><fo:block id="_analyse_de_emphasis_m_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Analyse de <fo:inline font-style="italic">M</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons procéder en trois étapes :</fo:block><fo:list-block id="idm45903951132048" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951131072" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Enregistrement du contenu hexadécimal
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951130208" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Conversion du contenu hexadécimal en binaire
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951129328" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Examen du contenu binaire avec la commande <fo:inline font-style="italic">openssl asn1parse</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="_1_enregistrement_du_contenu_hexad&#xE9;cimal"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">1 Enregistrement du contenu hexadécimal</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Faisons un copier-coller de <fo:inline font-style="italic">M</fo:inline> (en hexadécimal) à partir de l’octet qui suit l’octet nul, et enregistrons le résultat dans le fichier <fo:inline font-weight="bold"><fo:inline font-style="normal">m.hex</fo:inline></fo:inline>.</fo:block><fo:block id="idm45903951125344" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 13.  </fo:block><fo:block id="idm45903951124592"><fo:external-graphic src="url(./images/img-m.hex-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Contenu de m.hex. </fo:inline>
<fo:block id="idm45903951122048" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">3031300D0609608648016503040201050004208364DA78F1FD8DCC6812E568268BF2DAF8791BE383109745388879C496A8C3DD</fo:block>
</fo:block></fo:block><fo:block id="_2_conversion_du_contenu_hexad&#xE9;cimal_en_binaire"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">2 Conversion du contenu hexadécimal en binaire</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Maintenant nous allons convertir <fo:inline font-style="italic">m.hex</fo:inline> en binaire, puisque le contenu actuel est le <fo:inline font-style="italic">codage des octets en hexadécimal</fo:inline> de la signature, ce n’est pas la signature elle-même.</fo:block><fo:block><fo:block id="idm45903951118656" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 5. Linux</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter la commande</fo:block><fo:block id="idm45903951117632" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ xxd -r -p m.hex &gt; m.der</fo:block></fo:block></fo:block><fo:block><fo:block id="idm45903951116880" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 6. Windows</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le plus simple est d’utiliser <fo:inline font-style="italic">notepad++</fo:inline> et d’enregistrer le fichier transformé avec le nom <fo:inline font-style="italic">m.der</fo:inline>.</fo:block><fo:block id="idm45903951114976" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 14.  </fo:block><fo:block id="idm45903951114224"><fo:external-graphic src="url(./images/img-notepadpp-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903951112320" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 15.  </fo:block><fo:block id="idm45903951111568"><fo:external-graphic src="url(./images/img-notepadpp-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45903951109536" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Caution</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ne pas laisser un saut de ligne à la fin du fichier qui s’ajouterait aux données binaires de la signature.</fo:block></fo:block></fo:block><fo:block id="idm45903951108896" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"/><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le fichier <fo:inline font-style="italic">m.der</fo:inline> contient les octets que l’on avait dans la signature, ce que l’on peut vérifier facilement…</fo:block><fo:list-block id="idm45903951107536" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951107280" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
… sous Linux avec la commande <fo:inline font-style="italic">hd</fo:inline> (on peut aussi utiliser <fo:inline font-style="italic">hexdump</fo:inline> ou <fo:inline font-style="italic">xxd</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951105264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
… sous Windows avec <fo:inline font-style="italic">notepad++</fo:inline>, en reconvertissant en hexadécimal et en vérifiant que l’on retombe sur ses pieds.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903951103776" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 16.  </fo:block><fo:block id="idm45903951103024"><fo:external-graphic src="url(./images/img-m.der-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block><fo:block id="_3_examen_du_contenu_der_du_fichier_m_der"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">3 Examen du contenu DER du fichier m.der</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45903951100112" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">openssl</fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour afficher le contenu binaire (qui se trouve être encodé en DER) nous allons utiliser l’exécutable en ligne de commande fourni avec la librairie openssl. Cet outil s’appelle <fo:inline font-style="italic">openssl</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Par la suite nous utiliserons également <fo:inline font-style="italic">dder</fo:inline> et <fo:inline font-style="italic">pkfile</fo:inline>, deux utilitaires créés par l’auteur de cet article pour afficher et extraire plus facilement ce type de données.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">dder</fo:inline> est disponible à l’URL <fo:basic-link internal-destination="10"><fo:inline>[10]</fo:inline></fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">pkfile</fo:inline> est disponible à l’URL <fo:basic-link internal-destination="11"><fo:inline>[11]</fo:inline></fo:basic-link>.</fo:block><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Exécutable openssl</fo:block><fo:list-block id="idm45903951094672" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951094160" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sous Linux ce programme est disponible par défaut.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951093264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sous Windows il faut trouver un binaire à télécharger.
Le plus simple est de télécharger la version GNUWin32, disponible à cette URL <fo:basic-link internal-destination="12"><fo:inline>[12]</fo:inline></fo:basic-link>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La version proposée au téléchargement (en février 2016) date de 2008. Des binaires plus récents sont disponibles sur Internet.
Pour faire les manipulations décrites dans ce document, la version de GNUWin32 est suffisante.</fo:block><fo:list-block id="idm45903951090992" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951090736" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
À noter que Sous Windows les environnements "de taille importante" (<fo:inline font-style="italic">cygwin</fo:inline>, <fo:inline font-style="italic">perl</fo:inline>, …) sont souvent installés avec leur librairie openssl, qui contient l’outil en ligne de commande <fo:inline font-style="italic">openssl</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter la commande</fo:block><fo:block id="idm45903951087600" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl asn1parse -inform der -in m.der</fo:block><fo:block id="idm45903951086976" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 17.  </fo:block><fo:block id="idm45903951086224"><fo:external-graphic src="url(./images/img-m.der-openssl-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous verrons dans le chapitre suivant la syntaxe ASN.1 plus en détail.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La commande <fo:inline font-style="italic">openssl</fo:inline> (figure 17) nous donne deux informations :</fo:block><fo:list-block id="idm45903951082912" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951082656" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L’algorithme de hash est SHA-256, ce que l’on savait déjà d’après le contenu de <fo:inline font-style="italic">signatureAlgorithm</fo:inline> (deuxième partie de la structure en trois parties du certificat).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951081232" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Nous voyons la valeur du hash (le bloc <fo:inline font-family="monospace">prim: OCTET STRING</fo:inline>) sous forme hexadécimale. Sa longueur correspond bien au SHA-256 (256 bits de longueur soit 32 octets).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous savons désormais que la signature SHA-256 de la valeur tbsCertificate du certificat de <fo:inline font-style="italic">letsencrypt.org</fo:inline> devrait être :</fo:block><fo:block id="idm45903951078512" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">8364DA78F1FD8DCC6812E568268BF2DAF8791BE383109745388879C496A8C3DD</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">C’est ce que nous allons vérifier en calculant maintenant <fo:inline font-style="italic">M'</fo:inline>.</fo:block></fo:block></fo:block><fo:block id="_calcul_de_emphasis_m_emphasis_2"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Calcul de <fo:inline font-style="italic">M'</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons calculer <fo:inline font-style="italic">M'</fo:inline> en deux étapes :</fo:block><fo:list-block id="idm45903951074800" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903951073824" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Extraction de tbsCertificate du certificat <fo:inline font-style="italic">letsencrypt.org</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951072672" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Calcul du hash SHA-256 de tbsCertificate.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Mais avant d’extraire tbsCertificate, nous devons comprendre comment le certificat est structuré et codé.</fo:block><fo:block id="_asn_1_et_der"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">ASN.1 et DER</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au début de ce document, nous avons observé que la section 4.1 de la RFC 5280, qui définit la structure des certificats x509 v3, contient cette définition :</fo:block><fo:block id="idm45903951069456" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">Certificate  ::=  SEQUENCE  {
        tbsCertificate       TBSCertificate,
        signatureAlgorithm   AlgorithmIdentifier,
        signatureValue       BIT STRING  }</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un certificat x509 est défini selon la syntaxe ASN.1.
L’encodage peut être BER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">7</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">7</fo:inline>BER signifie <fo:inline font-weight="bold">B</fo:inline>asic <fo:inline font-weight="bold">E</fo:inline>ncoding <fo:inline font-weight="bold">R</fo:inline>ules</fo:block></fo:footnote-body></fo:footnote>
, CER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">8</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">8</fo:inline>CER signifie <fo:inline font-weight="bold">C</fo:inline>anonical <fo:inline font-weight="bold">E</fo:inline>ncoding <fo:inline font-weight="bold">R</fo:inline>ules</fo:block></fo:footnote-body></fo:footnote>
ou DER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">9</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">9</fo:inline>DER signifie <fo:inline font-weight="bold">D</fo:inline>istinguished <fo:inline font-weight="bold">E</fo:inline>ncoding <fo:inline font-weight="bold">R</fo:inline>ules</fo:block></fo:footnote-body></fo:footnote>
.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ces trois standards sont très proches, l’intérêt de DER étant son unicité : une structure de données spécifiée en ASN.1 ne peut être encodée en DER que d’une manière, et une seule. BER et CER permettent certaines variations dans la manière d’encoder.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour ne pas alourdir la rédaction, nous parlerons toujours d’encodage DER ou simplement DER, même lorsque les données manipulées pourraient ne pas être DER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">10</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">10</fo:inline>La RFC 5280 indique que les <fo:inline font-style="italic">données signées</fo:inline> d’un certificat (la partie tbsCertificate) doivent être encodées en DER, mais ne donne pas d’indication pour le reste.</fo:block></fo:footnote-body></fo:footnote>
.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">ASN.1 structure chaque valeur (<fo:inline font-style="italic">data value</fo:inline> dans le document X.690) selon la typologie <fo:inline font-weight="bold">T</fo:inline> - <fo:inline font-weight="bold">L</fo:inline> - <fo:inline font-weight="bold">V</fo:inline> ou <fo:inline font-weight="bold">T</fo:inline>ag - <fo:inline font-weight="bold">L</fo:inline>ength - <fo:inline font-weight="bold">V</fo:inline>alue.
La forme "longueur indéfinie" apporte un quatrième élément, "end-of-contents" (marqueur de fin de valeur), que nous ignorerons car DER ne permet pas cette forme.</fo:block><fo:list-block id="idm45903951052864" provisional-distance-between-starts="10em * 0.60+1em" provisional-label-separation="1em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em"><fo:list-item id="idm45903951052608" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
[<fo:inline font-weight="bold">T</fo:inline>]ag
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Définit toutes les caractéristiques de la valeur, notamment son <fo:inline font-style="italic">type</fo:inline>, par exemple une date (<fo:inline font-style="italic">UTCTime</fo:inline>), une séquence (<fo:inline font-style="italic">SEQUENCE</fo:inline> ou <fo:inline font-style="italic">SEQUENCE OF</fo:inline>), un entier (<fo:inline font-style="italic">INTEGER</fo:inline>), et bien d’autres. Il définit également si l’encodage de la valeur est <fo:inline font-style="italic">primitive</fo:inline> ou <fo:inline font-style="italic">contructed</fo:inline>.
</fo:block><fo:list-block id="idm45903951047744" provisional-distance-between-starts="24em * 0.60+1em" provisional-label-separation="1em"><fo:list-item id="idm45903951047488" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Encodage <fo:inline font-style="italic">primitive</fo:inline>
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La donnée ne contient pas de sous-structure
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951045456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Encodage <fo:inline font-style="italic">constructed</fo:inline>
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La donnée est elle-même une structure qui suit la typologie <fo:inline font-weight="bold">T</fo:inline>-<fo:inline font-weight="bold">L</fo:inline>-<fo:inline font-weight="bold">V</fo:inline>, et ici, cette structure est elle-même définie en ASN.1 <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">11</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">11</fo:inline>Certains types de données, notamment les <fo:inline font-style="italic">*string</fo:inline> (OCTET STRING, UTF8String, etc.), peuvent être <fo:inline font-style="italic">primitive</fo:inline> ou <fo:inline font-style="italic">constructed</fo:inline>, ce qui signifie que leur encodage peut suivre une structure hiérarchique "propre à l’encodage", non explicitée dans la définition de la valeur en ASN.1.</fo:block></fo:footnote-body></fo:footnote>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951039328" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Structure hiérarchique
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La différence <fo:inline font-style="italic">primitive</fo:inline> - <fo:inline font-style="italic">constructed</fo:inline> est à la base de la structure hiérarchique d’une spécification ASN.1, les éléments <fo:inline font-style="italic">constructed</fo:inline> étant les branches, les éléments <fo:inline font-style="italic">primitive</fo:inline> étant les feuilles.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans la définition d’un <fo:inline font-style="italic">Certificate</fo:inline> ci-dessus, le type <fo:inline font-style="italic">SEQUENCE</fo:inline> est, par définition du type <fo:inline font-style="italic">SEQUENCE</fo:inline> en ASN.1, <fo:inline font-style="italic">constructed</fo:inline>. Cela signifie que la valeur <fo:inline font-style="italic">SEQUENCE</fo:inline> est elle-même une structure ASN.1, ce qu’on peut voir dans la liste des trois composants d’un certificat définie entre accolades.</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951032992" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
[<fo:inline font-weight="bold">L</fo:inline>]ength
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Donne la longueur de la valeur en octets.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951030736" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
[<fo:inline font-weight="bold">V</fo:inline>]alue
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Est la donnée elle-même. Dans ce document nous employons le terme <fo:inline font-style="italic">valeur</fo:inline> (dans le document X.690 le terme est <fo:inline font-style="italic">data value</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Affichons le contenu DER avec l’utilitaire en ligne de commande <fo:inline font-style="italic">dder</fo:inline> en exécutant la commande suivante :</fo:block><fo:block id="idm45903951026592" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ dder -width 8 -recursive "|  " m.der</fo:block><fo:block id="idm45903951025968" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 18.  </fo:block><fo:block id="idm45903951025216"><fo:external-graphic src="url(./images/img-dder-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La copie d'écran de la figure 18 a été faite sous Windows pour changer un peu.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La description de la valeur indique <fo:inline font-style="italic">-cons</fo:inline> ou <fo:inline font-style="italic">-prim</fo:inline>, pour <fo:inline font-style="italic">constructed</fo:inline> ou <fo:inline font-style="italic">primitive</fo:inline>.
Chaque fois que le tag indique une valeur <fo:inline font-style="italic">constructed</fo:inline> (ici, il s’agit à deux reprises du type <fo:inline font-style="italic">SEQUENCE</fo:inline>, qui est obligatoirement <fo:inline font-style="italic">constructed</fo:inline>), on descend d’un niveau dans la structure hiérarchique, que l’on a fait ressortir ici avec l’option <fo:inline font-style="italic">-recursive "|  "</fo:inline>.</fo:block></fo:block><fo:block id="_extraction_de_tbscertificate_du_certificat_emphasis_letsencrypt_org_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Extraction de tbsCertificate du certificat <fo:inline font-style="italic">letsencrypt.org</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_&#xE9;tape_1_de_l_8217_extraction"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Étape 1 de l’extraction</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Commençons par enregistrer le certificat depuis le navigateur, dans le fichier <fo:inline font-style="italic">letsencryptorg.der</fo:inline>.</fo:block><fo:block><fo:block id="idm45903951015296" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 7. Firefox</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Afficher le certificat comme vu précédemment, puis afficher l’onglet <fo:inline font-style="italic">Détails</fo:inline> et cliquer sur le bouton <fo:inline font-style="italic">Exporter</fo:inline>.
Ensuite sélectionner <fo:inline font-style="italic">Certificat X.509 (DER)</fo:inline>.</fo:block><fo:block id="idm45903951012976" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 19.  </fo:block><fo:block id="idm45903951012336"><fo:external-graphic src="url(./images/img-certsave-ff-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45903951010304" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 8. Internet Explorer et Chrome</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Afficher le certificat, puis cliquer sur le bouton <fo:inline font-style="italic">Copier dans un fichier…</fo:inline>.
Ensuite sélectionner <fo:inline font-style="italic">X.509 binaire encodé DER</fo:inline>.</fo:block><fo:block id="idm45903951008416" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 20.  </fo:block><fo:block id="idm45903951007664"><fo:external-graphic src="url(./images/img-certsave-ie-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45903951005632" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">PEM versus DER</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Avec les certificats x509, l’encodage PEM est une surcouche de DER qui consiste à :</fo:block><fo:list-block id="idm45903951004368" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951004112" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Encoder le contenu binaire (après chiffrement éventuel) en BASE64
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951003184" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Ajouter au début et à la fin un texte standardisé qui définit et délimite la nature du contenu, ainsi que les informations de chiffrement s’il y a lieu
</fo:block><fo:list-block id="idm45903951002240" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903951001984" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La ligne ajoutée au début commence par <fo:inline font-weight="bold"><fo:inline font-family="monospace">-----BEGIN</fo:inline></fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903951000128" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La ligne ajoutée à la fin commence par <fo:inline font-weight="bold"><fo:inline font-family="monospace">-----END</fo:inline></fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Si vous avez enregistré le certificat avec un encodage PEM, vous pouvez le convertir en DER avec <fo:inline font-style="italic">openssl</fo:inline>. Exemple pour <fo:inline font-style="italic">letsencrypt.cer</fo:inline> (PEM) que l’on convertit en <fo:inline font-style="italic">letsencrypt.der</fo:inline> (DER)  - comme on peut voir, l’encodage par défaut avec <fo:inline font-style="italic">openssl</fo:inline> est PEM.</fo:block><fo:block id="idm45903950995664" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl x509 -in letsencryptorg.cer -outform der -out letsencryptorg.der</fo:block><fo:block id="idm45903950994944" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 21.  </fo:block><fo:block id="idm45903950994192"><fo:external-graphic src="url(./images/img-pem-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903950992288" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 22.  </fo:block><fo:block id="idm45903950991536"><fo:external-graphic src="url(./images/img-convpemder-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Vous pouvez faire cette conversion "à la main" en enlevant la première et la dernière ligne et en faisant une conversion BASE64 → binaire avec des outils comme <fo:inline font-style="italic">base64</fo:inline> (Linux) ou <fo:inline font-style="italic">notepad++</fo:inline> (Windows).</fo:block></fo:block></fo:block></fo:block><fo:block id="_&#xE9;tape_2_de_l_8217_extraction"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Étape 2 de l’extraction</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous disposons maintenant d’un certificat enregistré en binaire (encodage DER) dans le fichier <fo:inline font-style="italic">letsencryptorg.der</fo:inline>, dont nous allons à présent extraire la partie tbsCertificate.</fo:block><fo:block id="idm45903950985824" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les outils <fo:inline font-style="italic">dder</fo:inline> et <fo:inline font-style="italic">pkfile</fo:inline> (<fo:inline font-style="italic">pkfile</fo:inline> est présenté plus loin) peuvent lire indifféremment des fichiers codés en PEM ou en DER. Si le fichier est PEM, il est décodé à la volée.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Il y a deux solutions pour ce faire</fo:block><fo:list-block id="idm45903950983216" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903950982352" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
À la main
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950981584" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
À l’aide de l’utilitaire <fo:inline font-style="italic">pkfile</fo:inline>. <fo:inline font-style="italic">pkfile</fo:inline> est disponible à cette URL <fo:basic-link internal-destination="11"><fo:inline>[11]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Extraction de tbsCertificate : alernative 1 (à la main). </fo:inline>Un éditeur de fichier binaire ferait l’affaire, mais la manipulation est plus claire si l’on affiche le contenu hexadécimal avec <fo:inline font-style="italic">dder</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter la commande</fo:block><fo:block id="idm45903950977456" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ dder -recursive "|  " -hex letsencryptorg.der &gt; d</fo:block><fo:block id="idm45903950976720" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Encodage des fichiers affichés par dder</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">dder</fo:inline> lit indifféremment des fichiers PEM et DER. Si le fichier est PEM il décode (et décrypte si nécessaire) les données en mémoire avant d’afficher le contenu DER.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Donc la commande aurait pu être (avec le fichier <fo:inline font-style="italic">letsencryptorg.cer</fo:inline> encodé en PEM) :</fo:block><fo:block id="idm45903950974160" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ dder -recursive "|  " -hex letsencryptorg.cer &gt; d</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ouvrir le fichier <fo:inline font-style="italic">d</fo:inline> dans un éditeur de texte.
Comme on a affiché le contenu avec un décalage à chaque niveau hiérarchique (option <fo:inline font-style="italic">-recursive "|  "</fo:inline>), la structure en trois parties des certificats x509 ressort bien.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Supprimer les deux premières lignes et un certain nombre de lignes à la fin pour que seul demeure le contenu de tbsCertificate. Ci-dessous, le texte à conserver est le texte sélectionné (les lignes au milieu ont été supprimées pour condenser l’image).</fo:block><fo:block id="idm45903950970912" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 23.  </fo:block><fo:block id="idm45903950970160"><fo:external-graphic src="url(./images/img-extracttbs-alt1-1.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903950968256" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 24.  </fo:block><fo:block id="idm45903950967504"><fo:external-graphic src="url(./images/img-extracttbs-alt1-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ensuite :</fo:block><fo:list-block id="idm45903950965216" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903950964960" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer les "|" en début de ligne
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950964096" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer l’offset (numéro sur six caractères)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950963200" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer le texte après les codes hexadécimaux (une fois supprimé les "|" et l’offset en début de ligne, ce sont tous les caractères au-delà de la 55e position qu’il faut supprimer).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950961936" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer tous les espaces
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45903950960960" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 25.  </fo:block><fo:block id="idm45903950960208"><fo:external-graphic src="url(./images/img-extracttbs-alt1-3-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">On retrouve (figure 25) une sous-partie du fichier <fo:inline font-style="italic">letsencryptorg.der</fo:inline>, codée en hexadécimal, qui commence par <fo:inline font-weight="bold"><fo:inline font-family="monospace">308205ea</fo:inline></fo:inline> et se termine par <fo:inline font-weight="bold"><fo:inline font-family="monospace">2e6f7267</fo:inline></fo:inline>.</fo:block><fo:block id="idm45903950955456" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cette manipulation peut être faite avec un programme d'édition de fichier binaire, en ne gardant que les données à partir de l’offset 4, d’une longueur de 1518 octets.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Il faut ensuite convertir le contenu "codé hexadécimal" en binaire comme cela a été vu précédemment (commande <fo:inline font-style="italic">xxd -r -p</fo:inline> sous Linux, avec <fo:inline font-style="italic">notepad++</fo:inline> sous Windows).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au final on obtient le fichier <fo:inline font-style="italic">tbs.der</fo:inline> comme montré sur la figure 26.</fo:block><fo:block id="idm45903950952160" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 26.  </fo:block><fo:block id="idm45903950951408"><fo:external-graphic src="url(./images/img-extracttbs-alt1-4-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Extraction de tbsCertificate : alernative 2 (à l’aide de <fo:inline font-style="italic">pkfile</fo:inline>). </fo:inline>Exécuter la commande</fo:block><fo:block id="idm45903950948272" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ pkfile letsencryptorg.der -l 2</fo:block><fo:block id="idm45903950947648" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 27.  </fo:block><fo:block id="idm45903950946896"><fo:external-graphic src="url(./images/img-extracttbs-alt2-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le résultat visible sur la figure 27 nous montre que le tbsCertificate correspond à la valeur <fo:inline font-style="italic">SEQUENCE</fo:inline> de 1518 octets (4 octets d’en-tête, 1514 octets de données). <fo:inline font-style="italic">pkfile</fo:inline> donne à cette valeur les coordonnées 1.1.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous enregistrons cette valeur en binaire dans le fichier <fo:inline font-style="italic">tbs2.der</fo:inline> en exécutant la commande</fo:block><fo:block id="idm45903950942464" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ pkfile letsencryptorg.der -n 1.1 -x -o tbs2.der</fo:block><fo:block id="idm45903950941840" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 28.  </fo:block><fo:block id="idm45903950941088"><fo:external-graphic src="url(./images/img-extracttbs-alt2-2.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903950939184" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Encodage des fichiers analysés par pkfile</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">pkfile</fo:inline> lit indifféremment des fichiers PEM et DER. Si le fichier est PEM il décode (et décrypte si nécessaire) les données en mémoire avant de traiter le contenu DER.</fo:block></fo:block></fo:block></fo:block><fo:block id="_calcul_du_hash_de_tbscertificate"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Calcul du hash de tbsCertificate</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45903950936320" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 9. Linux</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le calcul des différents algorithmes de hash est disponible en ligne de commande. Pour SHA-256 le programme est <fo:inline font-style="italic">sha256sum</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter</fo:block><fo:block id="idm45903950934288" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ sha256sum tbs.der</fo:block><fo:block id="idm45903950933664" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 29.  </fo:block><fo:block id="idm45903950932912"><fo:external-graphic src="url(./images/img-calchash-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45903950930880" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 10. Windows</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Lels outils de calcul de hash ne sont pas disponibles par défaut. Voici quelques solutions (d’autres existent) :</fo:block><fo:list-block id="idm45903950929648" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903950929392" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Utiliser <fo:inline font-style="italic">pkfile</fo:inline>, qui permet de calculer différents hash<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">12</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">12</fo:inline><fo:inline font-style="italic">pkfile</fo:inline> peut le faire aussi sous Linux, mais dans ce système il est plus logique d’utiliser les programmes déjà installés. La fonctionnalité de calcul de hash a été ajoutée à <fo:inline font-style="italic">pkfile</fo:inline> pour simplifier les manipulations sous Windows.</fo:block></fo:footnote-body></fo:footnote>
.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950926512" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Installer les outils <fo:inline font-style="italic">GNUWin32</fo:inline>, disponibles à cette URL <fo:basic-link internal-destination="12"><fo:inline>[12]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950924864" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
7-ZIP ajoute des menus contextuels dans l’explorateur pour calculer différents hashs, dont SHA-256. 7-ZIP est disponible à cette URL <fo:basic-link internal-destination="13"><fo:inline>[13]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple avec <fo:inline font-style="italic">pkfile</fo:inline>, exécuter</fo:block><fo:block id="idm45903950922384" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ pkfile --sha256 tbs.der</fo:block><fo:block id="idm45903950921760" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 30.  </fo:block><fo:block id="idm45903950921008"><fo:external-graphic src="url(./images/img-calchash-2.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45903950919104" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 31.  </fo:block><fo:block id="idm45903950918352"><fo:external-graphic src="url(./images/img-calchash-3.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les captures d'écran montrent également le calcul sur le fichier <fo:inline font-style="italic">tbs2.der</fo:inline> (créé avec <fo:inline font-style="italic">pkfile</fo:inline>), qui est ben identique à <fo:inline font-style="italic">tbs.der</fo:inline>, ce qui confirme au passage l'équivalence des deux termes de l’alternative pour extraire tbsCertificate.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold">Le hash trouvé (<fo:inline font-style="normal">M'</fo:inline>) concorde avec la signature (<fo:inline font-style="normal">M</fo:inline>), ce qui valide la signature du certificat <fo:inline font-style="normal">letsencrypt.org</fo:inline></fo:inline></fo:block></fo:block></fo:block></fo:block><fo:block id="_conclusion"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Conclusion</fo:marker><fo:block font-size="17.28pt">Conclusion</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous arrivons au terme des manipulations à effectuer pour vérifier la signature RSA d’un certificat x509. Les calculs étaient élémentaires, mais cela nous a permis de voir :</fo:block><fo:list-block id="idm45903950910512" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903950910256" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les différents formats et encodages et les outils pour passer de l’un à l’autre
</fo:block><fo:list-block id="idm45903950909456" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903950909200" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
PEM versus DER
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950908432" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
BASE64 versus binaire
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950907664" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Hexadécimal versus binaire
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950906816" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
ASN.1
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950906048" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La structure de certificat x509
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950904944" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les solutions pour calculer sur des entiers de grande taille
</fo:block><fo:list-block id="idm45903950904160" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903950903904" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">python</fo:inline> (évoqué ici mais non détaillé) et <fo:inline font-style="italic">bc</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950902272" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les transformations éventuelles et précautions à prendre pour calculer en saisie et affichage hexadécimal
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950901264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La création de la fonction <fo:inline font-style="italic">powmod</fo:inline> dans <fo:inline font-style="italic">bc</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950899392" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Outils divers
</fo:block><fo:list-block id="idm45903950898752" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903950898496" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Calcul du hash d’un fichier
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950897728" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Extraction d’une valeur d’un fichier encodé en DER
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La <fo:inline font-style="italic">signature</fo:inline> a été vérifiée mais le certificat lui-même n’a pas été validé en totalité. Il y a deux raisons à cela.</fo:block><fo:list-block id="idm45903950895360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45903950894384" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Une fois un certificat vérifié, il faut vérifier son parent dans la hiérarchie (le certificat qui l’a signé), et ainsi de suite, jusqu'à vérifier un certificat connu dans la base des certificats du navigateur (les certificats <fo:inline font-style="italic">racine</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950892544" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le navigateur vérifie si les certificats rencontrés ont été révoqués à l’aide des Listes de Révocation des Certificats ou <fo:inline font-style="italic">CRL</fo:inline> (<fo:inline font-style="italic"><fo:inline font-weight="bold">C</fo:inline>ertificate <fo:inline font-weight="bold">R</fo:inline>evocation <fo:inline font-weight="bold">L</fo:inline>ist</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/></fo:block></fo:block><fo:block id="_bibliography" space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em"><fo:block><fo:block><fo:block margin-left="0pt" font-size="24.8832pt" font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Bibliography</fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45903950887440" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45903950887184" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="1"/>[1]</fo:inline> Présentation de l’ASN.1 : <fo:basic-link external-destination="url(http://www.itu.int/en/ITU-T/asn1/Pages/introduction.aspx)"><fo:inline hyphenate="false">http://www.itu.int/en/ITU-T/asn1/Pages/introduction.aspx</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950884400" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="2"/>[2]</fo:inline> Document X.690 (format PDF) : <fo:basic-link external-destination="url(https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf)"><fo:inline hyphenate="false">https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950881536" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="3"/>[3]</fo:inline> Article Wikipédia consacré au X.690 : <fo:basic-link external-destination="url(https://en.wikipedia.org/wiki/X.690)"><fo:inline hyphenate="false">https://en.wikipedia.org/wiki/X.690</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950878816" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="4"/>[4]</fo:inline> Article Wikipédia consacré au RSA : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Chiffrement_RSA)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Chiffrement_RSA</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950876096" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="5"/>[5]</fo:inline> Page d’accueil de <fo:inline font-style="italic">bc</fo:inline> : <fo:basic-link external-destination="url(https://www.gnu.org/software/bc/)"><fo:inline hyphenate="false">https://www.gnu.org/software/bc/</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950873088" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="6"/>[6]</fo:inline> <fo:inline font-style="italic">bc</fo:inline> pour Windows : <fo:basic-link external-destination="url(http://gnuwin32.sourceforge.net/packages/bc.htm)"><fo:inline hyphenate="false">http://gnuwin32.sourceforge.net/packages/bc.htm</fo:inline></fo:basic-link>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">bc</fo:inline> a besoin du fichier <fo:inline font-style="italic">readline5.dll</fo:inline> pour s’exécuter. Vous pouvez le trouver à cette URL : <fo:basic-link external-destination="url(http://gnuwin32.sourceforge.net/packages/readline.htm)"><fo:inline hyphenate="false">http://gnuwin32.sourceforge.net/packages/readline.htm</fo:inline></fo:basic-link></fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950868416" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="7"/>[7]</fo:inline> Le site de notepad++  : <fo:basic-link external-destination="url(https://notepad-plus-plus.org/fr)"><fo:inline hyphenate="false">https://notepad-plus-plus.org/fr</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950865792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="8"/>[8]</fo:inline> Article Wikipédia sur l’algorithme d’exponentiation rapide : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Exponentiation_rapide)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Exponentiation_rapide</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950863008" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="9"/>[9]</fo:inline> Article Wikipédia sur l’exponentiation modulaire : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Exponentiation_modulaire)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Exponentiation_modulaire</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950860224" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="10"/>[10]</fo:inline> Obtenir <fo:inline font-style="italic">dder</fo:inline> : <fo:basic-link external-destination="url(http://dder.sourceforge.net)"><fo:inline hyphenate="false">http://dder.sourceforge.net</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950857216" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="11"/>[11]</fo:inline> Obtenir <fo:inline font-style="italic">pkfile</fo:inline> : <fo:basic-link external-destination="url(http://pkfile.sourceforge.net)"><fo:inline hyphenate="false">http://pkfile.sourceforge.net</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950854208" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="12"/>[12]</fo:inline> GNUWin32 : <fo:basic-link external-destination="url(http://gnuwin32.sourceforge.net/packages/openssl.htm)"><fo:inline hyphenate="false">http://gnuwin32.sourceforge.net/packages/openssl.htm</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45903950851584" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="13"/>[13]</fo:inline> Télécharger 7-ZIP : <fo:basic-link external-destination="url(http://www.7-zip.org/download.html)"><fo:inline hyphenate="false">http://www.7-zip.org/download.html</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:flow></fo:page-sequence></fo:root>