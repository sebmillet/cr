<?xml version="1.0"?>
<fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format" font-family="serif,Symbol,ZapfDingbats" font-size="10pt" text-align="justify" line-height="normal" font-selection-strategy="character-by-character" line-height-shift-adjustment="disregard-shifts" writing-mode="lr-tb" language="en"><fo:layout-master-set><fo:simple-page-master master-name="blank" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body display-align="center" margin-bottom="0.5in" margin-top="0.5in" margin-left="0in" margin-right="0in" region-name="blank-body"/><fo:region-before region-name="xsl-region-before-blank" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-blank" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-blank" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-blank" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-first" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-odd" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-even" page-width="210mm" page-height="297mm" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:page-sequence-master master-name="titlepage"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="titlepage-first" page-position="first"/><fo:conditional-page-master-reference master-reference="titlepage-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="titlepage-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="lot"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="lot-first" page-position="first"/><fo:conditional-page-master-reference master-reference="lot-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="lot-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="front"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="front-first" page-position="first"/><fo:conditional-page-master-reference master-reference="front-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="front-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="body"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="body-first" page-position="first"/><fo:conditional-page-master-reference master-reference="body-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="body-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="back"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="back-first" page-position="first"/><fo:conditional-page-master-reference master-reference="back-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="back-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="index"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="index-first" page-position="first"/><fo:conditional-page-master-reference master-reference="index-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="index-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master></fo:layout-master-set><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="1" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Cryptographie pratique</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Cryptographie pratique</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="idm45336288197152"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block start-indent="0pt" text-align="center"><fo:block keep-with-next.within-column="always" font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="center" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Cryptographie pratique</fo:block></fo:block><fo:block space-before="0.5em" font-size="14.4pt"><fo:block>Sébastien Millet <fo:inline font-family="monospace"><fo:inline keep-together.within-line="always" hyphenate="false">&lt;&lt;milletseb@laposte.net&gt;&gt;</fo:inline></fo:inline></fo:block></fo:block><fo:block space-before="0.5em"><fo:table table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell number-columns-spanned="3"><fo:block>Revision History</fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell><fo:block>Revision 0.5</fo:block></fo:table-cell><fo:table-cell><fo:block>February 29th, 2016</fo:block></fo:table-cell><fo:table-cell><fo:block>SM</fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:block></fo:block></fo:block><fo:block id="toc...idm45336288197152" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block><fo:block><fo:block space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em" space-after="0.5em" start-indent="0pt" font-size="17.28pt" font-weight="bold" font-family="sans-serif,Symbol,ZapfDingbats">Table of Contents</fo:block></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_introduction">Introduction</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_introduction"><fo:page-number-citation ref-id="_introduction"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_le_format_x509">Le format x509</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_le_format_x509"><fo:page-number-citation ref-id="_le_format_x509"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45336288197152._le_format_x509" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_visualisation_d_8217_un_certificat_x509">Visualisation d’un certificat x509</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_visualisation_d_8217_un_certificat_x509"><fo:page-number-citation ref-id="_visualisation_d_8217_un_certificat_x509"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_structure_d_8217_un_certificat_x509">Structure d’un certificat x509</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_structure_d_8217_un_certificat_x509"><fo:page-number-citation ref-id="_structure_d_8217_un_certificat_x509"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_hi&#xE9;rarchie_des_certificats">Hiérarchie des certificats</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_hi&#xE9;rarchie_des_certificats"><fo:page-number-citation ref-id="_hi&#xE9;rarchie_des_certificats"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_v&#xE9;rification_de_signature_rsa">Vérification de signature RSA</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_v&#xE9;rification_de_signature_rsa"><fo:page-number-citation ref-id="_v&#xE9;rification_de_signature_rsa"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45336288197152._v&#xE9;rification_de_signature_rsa" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_la_signature_rsa">La signature RSA</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_la_signature_rsa"><fo:page-number-citation ref-id="_la_signature_rsa"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_v&#xE9;rification_du_certificat_de_letsencrypto_org">Vérification du certificat de letsencrypto.org</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_v&#xE9;rification_du_certificat_de_letsencrypto_org"><fo:page-number-citation ref-id="_v&#xE9;rification_du_certificat_de_letsencrypto_org"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_conclusion">Conclusion</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_conclusion"><fo:page-number-citation ref-id="_conclusion"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_v&#xE9;rification_de_signature_ecdsa">Vérification de signature ECDSA</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_v&#xE9;rification_de_signature_ecdsa"><fo:page-number-citation ref-id="_v&#xE9;rification_de_signature_ecdsa"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45336288197152._v&#xE9;rification_de_signature_ecdsa" margin-left="24pt"><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_cryptographie_&#xE0;_courbes_elliptiques">Cryptographie à courbes elliptiques</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_cryptographie_&#xE0;_courbes_elliptiques"><fo:page-number-citation ref-id="_cryptographie_&#xE0;_courbes_elliptiques"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="_bibliography">Bibliography</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="_bibliography"><fo:page-number-citation ref-id="_bibliography"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block id="_introduction"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Introduction</fo:marker><fo:block font-size="20.736pt">Introduction</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cet article décrit les calculs à réaliser pour vérifier des signatures RSA et ECDSA, dans le cas des certificats x509. Ces certificats sont couramment utilisés et servent notamment à la sécurisation https.</fo:block><fo:list-block id="idm45336284620320" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336285293232" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">RSA</fo:inline> : ce cas sera traité avec le certificat d’un serveur https.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336285214752" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">ECDSA</fo:inline> : nous commencerons par travailler sur un certificat auto-signé que nous créerons pour l’occasion, afin de se familiariser avec les calculs qu’implique la cryptographie à courbes elliptiques. Pour finir nous récupérerons un certificat CEV (<fo:inline font-style="italic"><fo:inline font-weight="bold">C</fo:inline>ertificat <fo:inline font-weight="bold">É</fo:inline>lectronique <fo:inline font-weight="bold">V</fo:inline>isible</fo:inline>) <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">1</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">1</fo:inline>Ce dernier cas sort du cadre x509.</fo:block></fo:footnote-body></fo:footnote>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au fil du document nous ferons appel aux outils suivants :</fo:block><fo:list-block id="idm45336286258496" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336285215744" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">openssl</fo:inline> pour travailler sur les certificats x509 en ligne de commande
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336286195712" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">pkfile</fo:inline> pour extraire la partie signée d’un certificat et <fo:inline font-style="italic">dder</fo:inline> pour afficher certains contenus binaires
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336285178768" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">python</fo:inline> ou <fo:inline font-style="italic">bc</fo:inline> pour faire des calculs avec des nombres entiers de grande taille
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336285731136" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Conversion entre encodage <fo:inline font-style="italic">PEM</fo:inline> et encodage <fo:inline font-style="italic">binaire</fo:inline> (Linux : <fo:inline font-style="italic">base64</fo:inline>, Windows : <fo:inline font-style="italic">notepad++</fo:inline>)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336287168544" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Édition de contenu de fichier binaire (Linux : <fo:inline font-style="italic">gvim/xxd</fo:inline>, Windows : <fo:inline font-style="italic">notepad++</fo:inline>)
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336286335808" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Windows versus Linux</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ce document s’adresse aux utilisateurs de Windows et Linux.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Il peut arriver qu’entre les deux environnements l’outil ou la commande à employer soit différente. Dans ce cas la solution pour chaque système est présentée.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/></fo:block><fo:block id="_le_format_x509"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Le format x509</fo:marker><fo:block font-size="20.736pt">Le format x509</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_visualisation_d_8217_un_certificat_x509"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Visualisation d’un certificat x509</fo:marker><fo:block font-size="17.28pt">Visualisation d’un certificat x509</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">A l’aide d’un navigateur, ouvrir une page en https et afficher le certificat.
Les exemples de ce document sont réalisés avec le certificat https du site <fo:basic-link external-destination="url(https://letsencrypt.org/)"><fo:inline hyphenate="false">https://letsencrypt.org/</fo:inline></fo:basic-link>.</fo:block><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Exemple avec Firefox 44</fo:block><fo:list-block id="idm45336289029488" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336289028160" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Cliquer sur l’icône de cadenas à gauche de la barre d’adresse et cliquer sur la flèche droite (Figure 1)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336289027232" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Cliquer sur <fo:inline font-style="italic">Plus d’informations</fo:inline> (Figure 2)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283559472" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Cliquer sur <fo:inline font-style="italic">Afficher le certificat</fo:inline> (Figure 3)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283558320" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>4.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Afficher l’onglet <fo:inline font-style="italic">Détails</fo:inline> et parcourir les différents champs du certificat (Figure 4, 5 et 6)
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336283556880" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 1.  </fo:block><fo:block id="idm45336283556128"><fo:external-graphic src="url(./images/img-firefox-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283554224" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 2.  </fo:block><fo:block id="idm45336283553472"><fo:external-graphic src="url(./images/img-firefox-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283551568" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 3.  </fo:block><fo:block id="idm45336283550816"><fo:external-graphic src="url(./images/img-firefox-3-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283548912" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 4.  </fo:block><fo:block id="idm45336283548160"><fo:external-graphic src="url(./images/img-firefox-4-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283546256" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 5.  </fo:block><fo:block id="idm45336283545504"><fo:external-graphic src="url(./images/img-firefox-5-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283543600" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 6.  </fo:block><fo:block id="idm45336283542848"><fo:external-graphic src="url(./images/img-firefox-6-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous nous intéresserons à la partie supérieure (<fo:inline font-style="italic">Hiérarchie des certificats</fo:inline>) plus tard.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour le moment examinons le certificat. L’affichage de Firefox en dessous de <fo:inline font-style="italic">Champs du certificat</fo:inline> liste trois parties :</fo:block><fo:list-block id="idm45336283539184" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283538208" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le certificat proprement dit, qui contient beaucoup d’informations structurées sur plusieurs niveaux hiérarchiques
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283537104" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L’algorithme de signature du certificat, dans notre exemple, <fo:inline font-style="italic">PKCS #1 SHA-256 avec chiffrement RSA</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283535792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La signature du certificat, ici, une suite de 256 octets
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cette structure en trois parties est toujours respectée pour un certificat x509.
A noter qu’Internet Explorer et Chrome affichent les mêmes informations mais sans faire ressortir la structure trois parties.</fo:block></fo:block><fo:block id="_structure_d_8217_un_certificat_x509"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Structure d’un certificat x509</fo:marker><fo:block font-size="17.28pt">Structure d’un certificat x509</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Où la structure d’un certificat est-elle définie, et quelle est cette définition ?</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Une recherche sur un moteur de recherche avec les mots-clés <fo:inline font-style="italic">RFC</fo:inline> et <fo:inline font-style="italic">x509</fo:inline> produit l’URL suivante dans les premières réponses :</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:basic-link external-destination="url(https://tools.ietf.org/html/rfc5280)"><fo:inline hyphenate="false">https://tools.ietf.org/html/rfc5280</fo:inline></fo:basic-link></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Et effectivement la<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">2</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">2</fo:inline>Nous utiliserons le féminin dans ce document. RFC étant un acronyme anglais, il n’y a pas d’argument définitif pour l’emploi du masculin ou du féminin.</fo:block></fo:footnote-body></fo:footnote>
<fo:inline font-weight="bold">RFC 5280</fo:inline> définit le format x509 version 3.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Affichons-la. Dans la section <fo:inline font-style="italic">4.1</fo:inline> se trouve la définition suivante.</fo:block><fo:block id="idm45336283527568" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">...
4.1.  Basic Certificate Fields

   The X.509 v3 certificate basic syntax is as follows.  For signature
   calculation, the data that is to be signed is encoded using the ASN.1
   distinguished encoding rules (DER) [X.690].  ASN.1 DER encoding is a
   tag, length, value encoding system for each element.

Certificate  ::=  SEQUENCE  {
        tbsCertificate       TBSCertificate,
        signatureAlgorithm   AlgorithmIdentifier,
        signatureValue       BIT STRING  }
...</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La suite définit les différents éléments du certificat, à savoir ce que sont les structures <fo:inline font-style="italic">TBSCertificate</fo:inline> et <fo:inline font-style="italic">AlgorithmIdentifier</fo:inline>.</fo:block><fo:block id="idm45336283524832" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">Grammaire, ASN.1 et DER</fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La structure du certificat est décrite par une <fo:inline font-style="italic">grammaire</fo:inline>, d’après les règles de syntaxe <fo:inline font-weight="bold">ASN.1</fo:inline> (<fo:inline font-weight="bold">A</fo:inline>bstrat <fo:inline font-weight="bold">S</fo:inline>yntax <fo:inline font-weight="bold">N</fo:inline>otation number <fo:inline font-weight="bold">1</fo:inline>) <fo:basic-link internal-destination="1"><fo:inline>[1]</fo:inline></fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les différents encodages possibles du standard <fo:inline font-style="italic">ASN.1</fo:inline> sont eux-mêmes des standards et le <fo:inline font-weight="bold">X.690</fo:inline> est l’un d’entre eux <fo:basic-link internal-destination="2"><fo:inline>[2]</fo:inline></fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La RFC précise que la partie du certificat à signer doit être encodée selon le standard <fo:inline font-style="italic">Distinguished Encoding Rules</fo:inline> ou <fo:inline font-weight="bold">DER</fo:inline>. Entre autres encodages, le document X.690 définit le DER.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous verrons plus loin l’encodage DER.
Si vous souhaitez le découvrir, plutôt que d’examiner directement le document X.690, je vous recommande de commencer par l’article Wikipédia <fo:basic-link internal-destination="3"><fo:inline>[3]</fo:inline></fo:basic-link>.</fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">En ASN.1 le mot-clé <fo:inline font-style="italic">SEQUENCE</fo:inline> sans autre précision indique que la valeur est constituée d’une suite de valeurs elles-mêmes spécifiées en ASN.1. La valeur <fo:inline font-style="italic">Certificate</fo:inline> contient donc, à la suite :</fo:block><fo:list-block id="idm45336283500560" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283499584" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur <fo:inline font-style="italic">tbsCertificate</fo:inline>, soit le certificat à signer (<fo:inline font-weight="bold">t</fo:inline>o <fo:inline font-weight="bold">b</fo:inline>e <fo:inline font-weight="bold">s</fo:inline>igned <fo:inline font-weight="bold">Certificate</fo:inline>)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283495936" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur <fo:inline font-style="italic">signatureAlgorithm</fo:inline>, soit l’identification de l’algorithme de signature
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283494688" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur <fo:inline font-style="italic">signatureValue</fo:inline>, soit la signature elle-même
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="_hi&#xE9;rarchie_des_certificats"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Hiérarchie des certificats</fo:marker><fo:block font-size="17.28pt">Hiérarchie des certificats</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans la partie tbsCertificate de <fo:inline font-style="italic">letsencrypt.org</fo:inline>, intéressons-nous à deux éléments en particulier, l'<fo:inline font-style="italic">émetteur</fo:inline> du certificat et le <fo:inline font-style="italic">sujet</fo:inline> du certificat.</fo:block><fo:list-block id="idm45336283490624" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283490368" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le <fo:inline font-style="italic">sujet</fo:inline> du certificat a pour <fo:inline font-weight="bold">CN</fo:inline> (<fo:inline font-weight="bold">C</fo:inline>ommon <fo:inline font-weight="bold">N</fo:inline>ame) letsencrypt.org et c’est le dernier nom qui est affiché dans la hiérarchie des certificats (partie supérieure de la fenêtre).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283487264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L'<fo:inline font-style="italic">émetteur</fo:inline> du certificat a pour CN <fo:inline font-style="italic">TrustID Server CA A52</fo:inline> et on peut voir ce nom au-dessus de letsencrypt.org dans la hiérarchie.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">L'émetteur et le sujet ont également le pays (<fo:inline font-weight="bold">C</fo:inline>) et l’organisation (<fo:inline font-weight="bold">O</fo:inline>) définis dans leur nom, ainsi que d’autres éléments.
Le "nom simple" ou "nom court" du certificat est son CN. Le standard x509 ne définit pas cette notion de "nom simple" ou "nom court", nous l’employons ici pour préciser que dans la pratique, le CN est le véritable nom du certificat, les autres éléments donnant des informations annexes.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cela dit, le nom (au sens du standard x509) est constitué du DN (<fo:inline font-style="italic"><fo:inline font-weight="bold">D</fo:inline>istinguished <fo:inline font-weight="bold">N</fo:inline>ame</fo:inline>), il s’agit de la <fo:inline font-style="italic">la totalité des éléments qui le composent</fo:inline> (et non pas seulement le CN).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le lien hiérarchique est toujours établi entre un émetteur et un sujet.
L'émetteur est celui qui signe le certificat, le sujet est celui qui est signé. Voir figures 7 et 8.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un certificat peut être à la fois émetteur (d’autres certificats sont signés par lui) et sujet (il est lui-même signé par un autre certificat), et cette chaîne forme une structure hiérarchique.
Dans notre exemple, on voit que le certificat <fo:inline font-style="italic">TrustID Server CA A52</fo:inline> est lui-même signé par <fo:inline font-style="italic">IdenTrust Commercial Root CA 1</fo:inline>.</fo:block><fo:block id="idm45336283478224" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans la pratique la situation peut se compliquer avec des certificats croisés. Quoi qu’il en soit, la structure de base des liens qui relient les certificats est hiérarchique.</fo:block></fo:block></fo:block><fo:block id="idm45336283477328" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">Quelques précisions</fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45336283476688" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283476432" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Pour qu’un certificat joue le rôle émetteur, il doit être une autorité de certification ou CA (<fo:inline font-style="italic"><fo:inline font-weight="bold">C</fo:inline>ertificate <fo:inline font-weight="bold">A</fo:inline>uthority</fo:inline>), il s’agit de l’une des nombreuses options que l’on peut trouver dans un certificat.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283473648" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
En plus des éléments permettant d’identifier le sujet du certificat, la partie tbsCertificate contient sa <fo:inline font-style="italic">clé publique</fo:inline>. C’est précisément le rôle du certificat : <fo:inline font-style="italic">certifier</fo:inline> la correspondance entre une entité (un DN) et une clé publique.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283471552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L'émetteur (qui est une autorité de certification) a toujours un numéro d’identification de clé (<fo:inline font-style="italic">Subject Key Identifier</fo:inline>). Cet identifiant, qui doit être par construction un entier, doit être enregistré dans les certificats émis comme numéro de clé d’autorité de certification (<fo:inline font-style="italic">Authority Key Identifier</fo:inline>). Cette logique permet de gérer facilement les cas où une autorité de certification possède plusieurs clés.
</fo:block><fo:list-block id="idm45336283469440" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283469184" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
En résumé, quand un émetteur signe un sujet, on doit avoir égalité entre ces différents éléments
</fo:block><fo:block id="idm45336283468320" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:table border-before-width.conditionality="retain" border-collapse="collapse" border-start-style="solid" border-end-style="solid" border-top-style="solid" border-bottom-style="solid" border-start-width="0.5pt" border-end-width="0.5pt" border-top-width="0.5pt" border-bottom-width="0.5pt" border-start-color="black" border-end-color="black" border-top-color="black" border-bottom-color="black" table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(44)"/><fo:table-column column-number="2" column-width="proportional-column-width(11)"/><fo:table-column column-number="3" column-width="proportional-column-width(44)"/><fo:table-header xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row keep-with-next.within-column="always"><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="center"><fo:block font-weight="bold">Dans le certificat émetteur </fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="center"><fo:block font-weight="bold">Lien </fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="center"><fo:block font-weight="bold">Dans le certificat sujet</fo:block></fo:table-cell></fo:table-row></fo:table-header><fo:table-body xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Subject DN
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline></fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="center"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">=</fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Issuer DN</fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Subject Key Identifier</fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="center"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">=</fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Authority Key Identifier</fo:block></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table><fo:block keep-with-previous.within-column="always"><fo:block font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" space-before="2pt" text-align="justify"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline>Ici on a un peu simplifié les choses pour ne pas alourdir le texte. En fait l'émetteur est identifié par son DN mais aussi par un <fo:inline font-style="italic">Serial Number</fo:inline>, nécessaire dans les cas où une même entité (DN) est associée à différentes clés. Donc le lien hiérarchique est établi avec le couple (DN, Serial Number), qui correspond à un couple (DN, key) de manière unique. Le DN seul ne serait pas suffisant. Les identifiants de clé correspondent (de manière bi-univoque) à un couple (DN, key).</fo:block></fo:block></fo:block></fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283451664" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La RFC 5280 (<fo:basic-link internal-destination="4"><fo:inline>[4]</fo:inline></fo:basic-link>) impose l’emploi d’identifiants de clé lors de l'émission de certificats mais la section <fo:inline font-style="italic">4.2.1.2</fo:inline> indique aussi que les applications ne sont pas obligées de vérifier les identifiants de clé lors de la validation d’une chaîne de certification. Conclusion ? Il n’y en a pas.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="idm45336283448944" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 7.  </fo:block><fo:block id="idm45336283448192"><fo:external-graphic src="url(./images/img-crt-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283446288" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 8.  </fo:block><fo:block id="idm45336283445536"><fo:external-graphic src="url(./images/img-crt-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour signer, l'émetteur utilise sa clé privée. La vérification de la signature est faite avec sa clé publique.
Ainsi pour vérifier l’authenticité du certificat https de <fo:inline font-style="italic">letsencrypt.org</fo:inline>, nous aurons besoin de la clé publique de son émetteur, <fo:inline font-style="italic">TrustID Server CA A52</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ce principe est toujours respecté avec les certificats x509, que ce soit avec RSA ou d’autres mécanismes à clé publique / clé privée.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons maintenant passer à la vérification de la signature RSA.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/></fo:block></fo:block><fo:block id="_v&#xE9;rification_de_signature_rsa"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Vérification de signature RSA</fo:marker><fo:block font-size="20.736pt">Vérification de signature RSA</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_la_signature_rsa"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">La signature RSA</fo:marker><fo:block font-size="17.28pt">La signature RSA</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45336283438544" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">Notations</fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45336283437904" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283437648" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La valeur à signer (ou si l’on préfère, le <fo:inline font-style="italic">bloc de données</fo:inline> à signer) est <fo:inline font-weight="bold">tbsCertificate</fo:inline>, soit le certificat sans les informations de signature. Dans la structure en trois parties de notre certificat x509, c’est la première.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283435616" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L’entité qui signe le certificat (l'émetteur du certificat) a pour clé RSA <fo:inline font-weight="bold">(n, e)</fo:inline> (<fo:inline font-weight="bold">n</fo:inline> est le modulo, <fo:inline font-weight="bold">e</fo:inline> est l’exposant) et <fo:inline font-weight="bold">d</fo:inline>.
Le couple <fo:inline font-weight="bold">(n, e)</fo:inline> est la clé publique, <fo:inline font-weight="bold">d</fo:inline> est la clé privée.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La page Wikipédia consacrée au système RSA <fo:basic-link internal-destination="5"><fo:inline>[5]</fo:inline></fo:basic-link> explique le lien entre <fo:inline font-style="italic">(n, e)</fo:inline> et <fo:inline font-style="italic">d</fo:inline>, et nous indique le calcul à effectuer pour <fo:inline font-style="italic">chiffrer</fo:inline>.
Pour <fo:inline font-style="italic">signer</fo:inline>, le calcul inverse le rôle de l’exposant privé et public, et pour <fo:inline font-style="italic">vérifier</fo:inline> la signature, le rôle des exposants privé et public est encore inversé (par rapport à la signature).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans notre exemple le tbsCertificate est celui de <fo:inline font-style="italic">letsencrypt.org</fo:inline>, tandis que la clé RSA (clé publique <fo:inline font-style="italic">(n, e)</fo:inline> et clé privée <fo:inline font-style="italic">d</fo:inline>) est celle de <fo:inline font-style="italic">TrustID Server CA A52</fo:inline>.</fo:block></fo:block><fo:block id="_calcul_de_la_signature"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Calcul de la signature</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45336283424432" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283423456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L'émetteur calcule le hash (noté <fo:inline font-style="italic">M</fo:inline>) de la valeur <fo:inline font-style="italic">tbsCertificate</fo:inline> du sujet, soit <fo:inline font-style="italic">M = hash("tbsCertificate")</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283421536" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Il calcule la signature
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">3</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">3</fo:inline>On simplifie ici pour se concentrer sur les étapes importantes. En fait, le hash <fo:inline font-style="italic">M</fo:inline> calculé n’est pas signé tel quel, il subit auparavant quelques transformations comme nous le verrons plus loin.</fo:block></fo:footnote-body></fo:footnote>
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">4</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">4</fo:inline>Ce calcul est le même que pour déchiffrer un message destiné au propriétaire de la clé publique (qui est ici l'émetteur du certificat). Signer en RSA revient à chiffrer en inversant le rôle de l’exposant public et privé.</fo:block></fo:footnote-body></fo:footnote>
(notée <fo:inline font-style="italic">S</fo:inline>) avec la formule <fo:inline font-style="italic">S = M<fo:inline font-size="75%" baseline-shift="super">d</fo:inline> mod n</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="_v&#xE9;rification_de_la_signature"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Vérification de la signature</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45336283416032" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283415168" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le vérificateur calcule <fo:inline font-style="italic">M = S<fo:inline font-size="75%" baseline-shift="super">e</fo:inline> mod n</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283413632" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Il calcule <fo:inline font-style="italic">M' = hash("tbsCertificate")</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283412400" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Si on a l'égalité <fo:inline font-style="italic">M = M'</fo:inline>, la signature est vérifiée
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block id="_v&#xE9;rification_du_certificat_de_letsencrypto_org"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Vérification du certificat de letsencrypto.org</fo:marker><fo:block font-size="17.28pt">Vérification du certificat de letsencrypto.org</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_choix_d_8217_un_programme_de_calcul"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Choix d’un programme de calcul</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous avons besoin d’une "calculatrice" qui calcule sur des nombres entiers arbitrairement grands, sans perte de précision. Dans la suite de ce document, c’est <fo:inline font-style="italic">bc</fo:inline> qui sera utilisé <fo:basic-link internal-destination="6"><fo:inline>[6]</fo:inline></fo:basic-link>.</fo:block><fo:list-block id="idm45336283407264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283407008" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Linux : <fo:inline font-style="italic">bc</fo:inline> est disponible par défaut sur la plupart des distributions.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283405712" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Windows : les binaires sont accessibles à l’URL <fo:basic-link internal-destination="7"><fo:inline>[7]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336283404192" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Le choix de bc</fo:block><fo:block><fo:list-block id="idm45336283403552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283403296" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">bc</fo:inline> est installé par défaut sur la plupart des distributions Linux, et facile et rapide à installer sous Windows.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283401904" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">bc</fo:inline> contient peu de fonctions mathématiques intégrées mais sur Internet on trouve de nombreux scripts qui permettent de l’enrichir considérablement.
</fo:block><fo:list-block id="idm45336283400624" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283400368" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Dans <fo:inline font-style="italic">bc</fo:inline> la variable <fo:inline font-style="italic">scale</fo:inline> définit le nombre de décimales des nombres manipulés. Comme nous ne ferons que des calculs sur des entiers, nous laisserons <fo:inline font-style="italic">scale</fo:inline> à zéro (pas de partie décimale). Zéro est la valeur par défaut de <fo:inline font-style="italic">scale</fo:inline> au lancement de <fo:inline font-style="italic">bc</fo:inline>
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">5</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">5</fo:inline>Lorsque <fo:inline font-style="italic">bc</fo:inline> est lancé avec l’option <fo:inline font-weight="bold"><fo:inline font-style="normal">-l</fo:inline></fo:inline>, des fonctions mathématiques sont chargées au démarrage et <fo:inline font-style="italic">scale</fo:inline> vaut 20. Nous ne nous servirons pas de cette option dans ce document et <fo:inline font-style="italic">scale</fo:inline> sera toujours égal à zéro.</fo:block></fo:footnote-body></fo:footnote>
.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block id="idm45336283394000" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Alternatives à bc</fo:block><fo:block><fo:list-block id="idm45336283393360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283393104" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold">sagemath</fo:inline>, logiciel mathématique en licence GPL.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283391616" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold">python</fo:inline>, langage de programmation en licence GPL, calcule par défaut sur des entiers de taille arbitrairement grande et convient donc aux calculs que nous allons faire.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283389888" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Logiciels mathématiques propriétaires bien connus.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block id="idm45336283388736" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Table 1. Comparaison entre <fo:inline font-style="italic">bc</fo:inline> et <fo:inline font-style="italic">python</fo:inline></fo:block><fo:table border-before-width.conditionality="retain" border-collapse="collapse" border-start-style="solid" border-end-style="solid" border-top-style="solid" border-bottom-style="solid" border-start-width="0.5pt" border-end-width="0.5pt" border-top-width="0.5pt" border-bottom-width="0.5pt" border-start-color="black" border-end-color="black" border-top-color="black" border-bottom-color="black" table-layout="fixed" width="100%"><fo:table-column column-number="1" column-width="proportional-column-width(50)"/><fo:table-column column-number="2" column-width="proportional-column-width(50)"/><fo:table-header xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row keep-with-next.within-column="always"><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="center"><fo:block font-weight="bold">bc </fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="center"><fo:block font-weight="bold">python</fo:block></fo:table-cell></fo:table-row></fo:table-header><fo:table-body xmlns:rx="http://www.renderx.com/XSL/Extensions" start-indent="0pt" end-indent="0pt"><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="center" number-columns-spanned="2"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Saisie d’un entier en hexadécimal</fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter au préalable</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">ibase = 2 * 8</fo:inline> <fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">ibase = 2 * 8</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">var = ABEF0E0</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">(Attention les caractères hexadécimaux doivent être en majuscule.)</fo:inline></fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Saisir l’entier précédé de <fo:inline font-style="italic">0x</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">&gt;&gt;&gt; var = 0xabef0e0</fo:inline>
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">b</fo:inline></fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" display-align="before" text-align="center" number-columns-spanned="2"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Affichage d’entier en hexadécimal</fo:block></fo:block></fo:table-cell></fo:table-row><fo:table-row><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" border-end-width="0.5pt" border-end-style="solid" border-end-color="black" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter au préalable</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">obase = 2 * 8</fo:inline>
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">obase = 2 * 8</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">2 ^ (2 ^ 4) + 1</fo:inline>
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">c</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">10001</fo:inline></fo:block></fo:block></fo:table-cell><fo:table-cell padding-start="2pt" padding-end="2pt" padding-top="2pt" padding-bottom="2pt" display-align="before" text-align="left"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Interpoler avec <fo:inline font-style="italic">%x</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple :</fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">&gt;&gt;&gt; '%x' % (2 ** (2 ** 4) + 1)</fo:inline></fo:block>
<fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-family="monospace">'10001'</fo:inline></fo:block></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table><fo:block keep-with-previous.within-column="always"><fo:block font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" space-before="2pt" text-align="justify"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline><fo:inline font-style="italic">2 * 8</fo:inline> produit toujours 16 (décimal). Si <fo:inline font-style="italic">16</fo:inline> est lu alors qu’ibase vaut déjà 16</fo:block></fo:block><fo:block font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" space-before="2pt" text-align="justify"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">b</fo:inline><fo:inline font-style="italic">python</fo:inline> peut lire les nombres hexadécimaux indifféremment en majuscule et minuscule. <fo:inline font-style="italic">bc</fo:inline> exige des majuscules.</fo:block></fo:block><fo:block font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" space-before="2pt" text-align="justify"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">c</fo:inline>Sous Windows, <fo:inline font-style="italic">bc</fo:inline> a des difficultés à lire le caractère <fo:inline font-style="italic">circonflexe</fo:inline> au clavier (en-dessous de la touche <fo:inline font-weight="bold">9</fo:inline>). Pour contourner ce problème, il est possible d’utiliser (sur un clavier français) l’accent circonflexe à droite de la touche <fo:inline font-weight="bold">P</fo:inline>, en appuyant dessus à deux reprises. Cela affiche deux <fo:inline font-style="italic">circonflexes</fo:inline> et vous devez alors en supprimer un.</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_enregistrement_de_la_signature_sous_forme_d_8217_entier"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Enregistrement de la signature sous forme d’entier</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45336283354608" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283353632" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Depuis le navigateur, afficher la signature du certificat de <fo:inline font-style="italic">letsencrypt.org</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283352480" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sélectionner la signature et la copier-coller dans un éditeur de texte.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283351552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer les caractère surnuméraires (enlever les <fo:inline font-style="italic">:</fo:inline> et les sauts de ligne).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283350272" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>4.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Passer les caractères hexadécimaux en majuscule <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">6</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">6</fo:inline>Si vous utilisez <fo:inline font-style="italic">python</fo:inline>, il est inutile de passer les caractères hexadécimaux en majuscule.</fo:block></fo:footnote-body></fo:footnote>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283348336" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>5.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Ajouter <fo:inline font-style="italic">s=</fo:inline> devant le nombre, et ajouter une première ligne <fo:inline font-style="italic">ibase = 2 * 8</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283346688" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>6.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Enregistrer dans <fo:inline font-weight="bold"><fo:inline font-style="normal">val.b</fo:inline></fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Voir figures 9 et 10.</fo:block><fo:block id="idm45336283344656" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 9.  </fo:block><fo:block id="idm45336283343904"><fo:external-graphic src="url(./images/img-cle-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283342000" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 10.  </fo:block><fo:block id="idm45336283341248"><fo:external-graphic src="url(./images/img-cle-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">L’instruction <fo:inline font-style="italic">ibase = 2 * 8</fo:inline> ordonne à bc de lire les nombres en hexadécimal.
<fo:inline font-style="italic">ibase = 16</fo:inline> fonctionne aussi, à condition qu’ibase soit égal à 10 (valeur par défaut) au moment d’exécuter <fo:inline font-style="italic">ibase = 16</fo:inline>.
Si ibase est déjà égal à 16 et que l’on exécute <fo:inline font-style="italic">ibase = 16</fo:inline>, une erreur se produit car bc lit 16 en hexadécimal (soit 22) et cette valeur est interdite.</fo:block><fo:block id="idm45336283336640" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:list-block id="idm45336283336384" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283335408" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Avec <fo:inline font-style="italic">bc</fo:inline> il est impératif de passer les nombres hexadécimaux en majuscule.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283334096" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">bc</fo:inline> n’accepte pas les noms de variable qui contiennent des majuscules.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le navigateur affiche l’exposant de la clé RSA (le nombre noté <fo:inline font-style="italic">e</fo:inline> tout à l’heure) sous forme décimale, alors que dans le script bc nous l’entrons en hexadécimal. Pour convertir un nombre décimal en hexadécimal, exécuter dans un terminal :</fo:block><fo:block><fo:block id="idm45336283331376" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 1. Linux</fo:block><fo:block id="idm45336283330736" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ echo "obase=16; 65537" | bc
10001</fo:block></fo:block></fo:block><fo:block><fo:block id="idm45336283329904" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 2. Windows</fo:block><fo:block id="idm45336283329264" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ echo obase=16; 65537 | bc.exe
10001</fo:block></fo:block></fo:block><fo:block id="idm45336283328416" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">Passer du texte en majuscule</fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45336283327776" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 3. Linux</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Sous Linux, on peut utiliser la ligne de commande, par exemple (nombreuses autres solutions) :</fo:block><fo:block id="idm45336283326544" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ tr '[:lower:]' '[:upper:]' &lt; fichier_entrée &gt; fichier_sortie</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un éditeur suffisamment avancé comme <fo:inline font-style="italic">vim</fo:inline> ou <fo:inline font-style="italic">emacs</fo:inline> le permet aussi.</fo:block></fo:block></fo:block><fo:block><fo:block id="idm45336283324368" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 4. Windows</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Windows ne dispose pas par défaut d’outil pour passer du texte en majuscule. Il faut installer <fo:inline font-style="italic">GNUWin32</fo:inline> ou <fo:inline font-style="italic">cygwin</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">L'éditeur de texte (natif) adéquat pour ce type de transformation est <fo:inline font-weight="bold"><fo:inline font-style="normal">notepad++</fo:inline></fo:inline>, disponible à cette URL <fo:basic-link internal-destination="8"><fo:inline>[8]</fo:inline></fo:basic-link>.</fo:block><fo:block id="idm45336283320496" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">vim</fo:inline> et <fo:inline font-style="italic">emacs</fo:inline> sont disponibles sous Windows.</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_enregistrement_de_la_cl&#xE9;_publique_sous_forme_d_8217_entier"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Enregistrement de la clé publique sous forme d’entier</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Depuis le navigateur :</fo:block><fo:list-block id="idm45336283317344" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283316368" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sélectionner le certificat de <fo:inline font-style="italic">TrustID Server CA A52</fo:inline> et afficher sa clé publique.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283315136" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sélectionner la valeur de la clé publique et la copier-coller dans <fo:inline font-weight="bold"><fo:inline font-style="normal">val.b</fo:inline></fo:inline>.
Il faut le faire en deux fois, une fois pour le modulo de 256 octets (variable <fo:inline font-style="italic">n</fo:inline>) et une fois pour l’exposant (variable <fo:inline font-style="italic">e</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ne pas oublier de passer les caractères hexadécimaux en majuscule.</fo:block><fo:block id="idm45336283311840" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 11.  </fo:block><fo:block id="idm45336283311088"><fo:external-graphic src="url(./images/img-cle-3-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">A l’arrivée, <fo:inline font-weight="bold"><fo:inline font-style="normal">val.b</fo:inline></fo:inline> contient trois variables, s, n et e.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">val.b. </fo:inline>
<fo:block id="idm45336283307408" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">ibase=2*8

s=8049A7CE9627701FC4E520876B97271A8AEF34D13A5ECA776172BD7C9053DBEF9C8504E4C85629135D934D1F9C6FB09375189812B3475D5F0797F5D32BC9B11B12BC29733DCD40E57EB97BC819F21939764A4F2A270036906BAE5FD280D68DCC16428C0FCD3D213025BCFA10A6697529ED1A168E0D2CEFCB24A9C9A64C85F0BF8942B91F2CD1E92989F73EF9F2267BAB5535C3388C10C3C1D55DBC3A50A01A77CEDED612862D83A9B1A68A08B68DC35BE0F2E23E3BD9AFD4C0BA1537CFD694A5AF5D6CF8887861A9DCB89B9DE35AD3F255C251B0ECD54C2CF693DD5732EDF33939334BDB1E64C29636E0502E57914984BDA74C7E05AC948403D2BEBE051452F8

n=9769D7999885023FE9264276E8F4733FA932442690782E78579119A05D762B49F9935A5D5ACE82F3C2D8E54C367A2B1D0DDBA6A7FE91127CED7201B78CA1C5DACC9DFE09FB57E214470FE89E918F942D8032939303F5287868BA7E0F42B4317A0514225333E4A3AD6C8FAFBE636BB2329FD917B9C9E0607C99D631E1E4A0B73FAFB232AC7E8C9CDC02EBE1BC1F149CBC91F7B2FB42F3E1202BCBBF8FF3B37063FAF7752802ABC5D4B0EDEA257F87CD371496833C40021BA09E19477FF3B0CCC52560B83512F151EB17DCFC5BA5D99BEF404CD77771E9FB458B7EF2E369B042661746903ACD463DF1B0096FDCFFEE3361CAFCC72E3CED5E0AD1BF221269804B23

e=10001</fo:block>
</fo:block></fo:block><fo:block id="_la_fonction_powmod"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">La fonction powmod</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les amateurs de <fo:inline font-style="italic">python</fo:inline> ont encore un avantage à ce stade. L'équivalent de la fonction <fo:inline font-style="italic">powmod</fo:inline> y est disponible sous forme d’un troisième paramètre (facultatif) à la fonction <fo:inline font-style="italic">pow</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour ceux qui utilisent bc comme moi, il faut écrire la fonction.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La fonction <fo:inline font-style="italic">powmod</fo:inline> met en oeuvre l’algorithme d’exponentiation rapide, décrit à cette URL <fo:basic-link internal-destination="9"><fo:inline>[9]</fo:inline></fo:basic-link>.
En fait nous sommes dans un contexte modulaire et d’après Wikipédia le nom exact de l’algorithme est <fo:inline font-style="italic">exponentiation modulaire</fo:inline>. Un article y est consacrée <fo:basic-link internal-destination="10"><fo:inline>[10]</fo:inline></fo:basic-link>.
Les deux algorithmes font appel au même principe, mais le second exploite le contexte modulaire pour que les nombres manipulés n’atteignent pas une taille démesurée. C’est le second algorithme (<fo:inline font-style="italic">exponentiation modulaire</fo:inline>) dont nous avons besoin pour la suite.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Sur Internet, on peut trouver la fonction <fo:inline font-style="italic">powmod</fo:inline> dans de nombreux scripts <fo:inline font-style="italic">bc</fo:inline> à télécharger. À noter qu’elle porte parfois d’autres noms, <fo:inline font-style="italic">mpower</fo:inline> par exemple.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">powmod.b. </fo:inline>
<fo:block id="idm45336283295168" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">define powmod(a, b, c) {
        auto p, r
        p = a
        r = 1
        while (b &gt; 0) {
                if (b % 2) r = (r * p) % c
                p = (p * p) % c
                b /= 2
        }
        return r
}</fo:block>
</fo:block></fo:block><fo:block id="_calcul_de_emphasis_m_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Calcul de <fo:inline font-style="italic">M</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous voilà prêts pour calculer <fo:inline font-style="italic">M</fo:inline>.</fo:block><fo:list-block id="idm45336283291360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283290384" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Lancer la commande suivante <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">7</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">7</fo:inline>Par défaut, <fo:inline font-style="italic">bc</fo:inline> ajoute un anti-slash après le 68e caractère et passe à la ligne suivante. On peut modifier ce comportement avec la variable d’environnement <fo:inline font-style="italic">BC_LINE_LENGTH</fo:inline>. Quand cette variable est égale à zéro, les nombres ne sont pas coupés.</fo:block></fo:footnote-body></fo:footnote> :
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336283287760" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ BC_LINE_LENGTH=0 bc powmod.b val.b</fo:block><fo:list-block id="idm45336283287136" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283285792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Dans le shell <fo:inline font-style="italic">bc</fo:inline>, exécuter
<fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">a</fo:inline> (pour que les nombres soient affichés en hexadécimal)
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336283284000" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">obase=2*8</fo:block><fo:list-block id="idm45336283283376" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283282032" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Toujours dans le shell <fo:inline font-style="italic">bc</fo:inline>, exécuter
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336283280752" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">powmod(s, e, n)</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Rappelons que c’est <fo:inline font-style="italic">S</fo:inline> (variable <fo:inline font-style="italic">s</fo:inline> dans <fo:inline font-style="italic">val.b</fo:inline>) qui doit être élevé à la puissance <fo:inline font-style="italic">e</fo:inline>, modulo <fo:inline font-style="italic">n</fo:inline>.
Lors de la définition d’obase, ibase vaut 16 (résultat du script <fo:inline font-style="italic">val.b</fo:inline> chargé au démarrage) donc obase=16 ne fonctionnerait pas.</fo:block><fo:block id="idm45336283277184" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 12.  </fo:block><fo:block id="idm45336283276432"><fo:external-graphic src="url(./images/img-powmod-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283274528" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Important</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au démarrage de bc, ibase est égal à 16 du fait du chargement de <fo:inline font-style="italic">val.b</fo:inline>. Si vous exécutez obase = 16, obase sera égal à… 22 !
C’est logique, puisque 16 est saisi en hexadécimal. Le plus simple est d’utiliser <fo:inline font-style="italic">2 * 8</fo:inline> comme indiqué. Vous pouvez aussi exécuter <fo:inline font-style="italic">obase = 10</fo:inline> (ibase étant égal à 16), mais c’est moins clair, et vous devez être certain qu’ibase vaut bien 16 au moment d’exécuter <fo:inline font-style="italic">obase = 10</fo:inline>, pour passer l’affichage des nombres en hexadécimal
(<fo:inline font-style="italic">2 * 8</fo:inline> fonctionne toujours quelle que soit la valeur d’ibase, y compris pour les valeurs inférieures ou égales à 7).</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le résultat (figure 12) avec tous ces <fo:inline font-style="italic">F</fo:inline> prouve avec une quasi certitude que le calcul s’est bien passé.
Les <fo:inline font-style="italic">F</fo:inline> correspondent au <fo:inline font-style="italic">padding</fo:inline> standard effectué pour une signature RSA, la valeur qui suit (à partir de <fo:inline font-weight="bold"><fo:inline font-family="monospace">303130</fo:inline></fo:inline>) est le hash de tbsCertificate "emballé".</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">"Emballé", c’est-à-dire ? La valeur est spécifiée en ASN.1 et codée en DER, et elle contient d’autres informations que le seul hash de tbsCertificate.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">C’est ce que nous allons voir dans le chapitre suivant.</fo:block></fo:block><fo:block id="_analyse_de_emphasis_m_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Analyse de <fo:inline font-style="italic">M</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons procéder en trois étapes :</fo:block><fo:list-block id="idm45336283265008" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283264032" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Enregistrement du contenu hexadécimal
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283263168" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Conversion du contenu hexadécimal en binaire
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283262288" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Examen du contenu binaire avec la commande <fo:inline font-style="italic">openssl asn1parse</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="_1_enregistrement_du_contenu_hexad&#xE9;cimal"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">1 Enregistrement du contenu hexadécimal</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Faisons un copier-coller de <fo:inline font-style="italic">M</fo:inline> (en hexadécimal) à partir de l’octet qui suit l’octet nul, et enregistrons le résultat dans le fichier <fo:inline font-weight="bold"><fo:inline font-style="normal">m.hex</fo:inline></fo:inline>.</fo:block><fo:block id="idm45336283258304" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 13.  </fo:block><fo:block id="idm45336283257552"><fo:external-graphic src="url(./images/img-m.hex-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Contenu de m.hex. </fo:inline>
<fo:block id="idm45336283255008" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">3031300D0609608648016503040201050004208364DA78F1FD8DCC6812E568268BF2DAF8791BE383109745388879C496A8C3DD</fo:block>
</fo:block></fo:block><fo:block id="_2_conversion_du_contenu_hexad&#xE9;cimal_en_binaire"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">2 Conversion du contenu hexadécimal en binaire</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Maintenant nous allons convertir <fo:inline font-style="italic">m.hex</fo:inline> en binaire, puisque le contenu actuel est le <fo:inline font-style="italic">codage des octets en hexadécimal</fo:inline> de la signature, ce n’est pas la signature elle-même.</fo:block><fo:block><fo:block id="idm45336283251616" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 5. Linux</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter la commande</fo:block><fo:block id="idm45336283250592" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ xxd -r -p m.hex &gt; m.der</fo:block></fo:block></fo:block><fo:block><fo:block id="idm45336283249840" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 6. Windows</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le plus simple est d’utiliser <fo:inline font-style="italic">notepad++</fo:inline> et d’enregistrer le fichier transformé avec le nom <fo:inline font-style="italic">m.der</fo:inline>.</fo:block><fo:block id="idm45336283247936" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 14.  </fo:block><fo:block id="idm45336283247184"><fo:external-graphic src="url(./images/img-notepadpp-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283245280" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 15.  </fo:block><fo:block id="idm45336283244528"><fo:external-graphic src="url(./images/img-notepadpp-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45336283242496" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Caution</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ne pas laisser un saut de ligne à la fin du fichier qui s’ajouterait aux données binaires de la signature.</fo:block></fo:block></fo:block><fo:block id="idm45336283241856" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"/><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le fichier <fo:inline font-style="italic">m.der</fo:inline> contient les octets que l’on avait dans la signature, ce que l’on peut vérifier facilement…</fo:block><fo:list-block id="idm45336283240496" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283240240" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
… sous Linux avec la commande <fo:inline font-style="italic">hd</fo:inline> (on peut aussi utiliser <fo:inline font-style="italic">hexdump</fo:inline> ou <fo:inline font-style="italic">xxd</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283238224" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
… sous Windows avec <fo:inline font-style="italic">notepad++</fo:inline>, en reconvertissant en hexadécimal et en vérifiant que l’on retombe sur ses pieds.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336283236736" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 16.  </fo:block><fo:block id="idm45336283235984"><fo:external-graphic src="url(./images/img-m.der-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block><fo:block id="_3_examen_du_contenu_der_du_fichier_m_der"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">3 Examen du contenu DER du fichier m.der</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45336283233072" border-style="solid" border-width="1pt" border-color="black" background-color="#DDDDDD" padding-start="12pt" padding-end="12pt" padding-top="6pt" padding-bottom="6pt" margin-left="0pt" margin-right="0pt" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block><fo:block><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block font-weight="bold" hyphenate="false" text-align="start" keep-with-next.within-column="always">openssl</fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour afficher le contenu binaire (qui se trouve être encodé en DER) nous allons utiliser l’exécutable en ligne de commande fourni avec la librairie openssl. Cet outil s’appelle <fo:inline font-style="italic">openssl</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Par la suite nous utiliserons également <fo:inline font-style="italic">dder</fo:inline> et <fo:inline font-style="italic">pkfile</fo:inline>, deux utilitaires créés par l’auteur de cet article pour afficher et extraire plus facilement ce type de données.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">dder</fo:inline> est disponible à l’URL <fo:basic-link internal-destination="11"><fo:inline>[11]</fo:inline></fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">pkfile</fo:inline> est disponible à l’URL <fo:basic-link internal-destination="12"><fo:inline>[12]</fo:inline></fo:basic-link>.</fo:block><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Exécutable openssl</fo:block><fo:list-block id="idm45336283227632" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283227120" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sous Linux ce programme est disponible par défaut.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283226224" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sous Windows il faut trouver un binaire à télécharger.
Le plus simple est de télécharger la version GNUWin32, disponible à cette URL <fo:basic-link internal-destination="13"><fo:inline>[13]</fo:inline></fo:basic-link>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La version proposée au téléchargement (en février 2016) date de 2008. Des binaires plus récents sont disponibles sur Internet.
Pour faire les manipulations décrites dans ce document, la version de GNUWin32 est suffisante.</fo:block><fo:list-block id="idm45336283223952" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283223696" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
À noter que Sous Windows les environnements "de taille importante" (<fo:inline font-style="italic">cygwin</fo:inline>, <fo:inline font-style="italic">perl</fo:inline>, …) sont souvent installés avec leur librairie openssl, qui contient l’outil en ligne de commande <fo:inline font-style="italic">openssl</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter la commande</fo:block><fo:block id="idm45336283220560" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl asn1parse -inform der -in m.der</fo:block><fo:block id="idm45336283219936" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 17.  </fo:block><fo:block id="idm45336283219184"><fo:external-graphic src="url(./images/img-m.der-openssl-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous verrons dans le chapitre suivant la syntaxe ASN.1 plus en détail.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La commande <fo:inline font-style="italic">openssl</fo:inline> (figure 17) nous donne deux informations :</fo:block><fo:list-block id="idm45336283215872" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283215616" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
L’algorithme de hash est SHA-256, ce que l’on savait déjà d’après le contenu de <fo:inline font-style="italic">signatureAlgorithm</fo:inline> (deuxième partie de la structure en trois parties du certificat).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283214192" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Nous voyons la valeur du hash (le bloc <fo:inline font-weight="bold"><fo:inline font-family="monospace">prim: OCTET STRING</fo:inline></fo:inline>) sous forme hexadécimale. Sa longueur correspond bien au SHA-256 (256 bits de longueur soit 32 octets).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous savons désormais que la signature SHA-256 de la valeur tbsCertificate du certificat de <fo:inline font-style="italic">letsencrypt.org</fo:inline> devrait être :</fo:block><fo:block id="idm45336283211104" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">8364DA78F1FD8DCC6812E568268BF2DAF8791BE383109745388879C496A8C3DD</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">C’est ce que nous allons vérifier en calculant maintenant <fo:inline font-style="italic">M'</fo:inline>.</fo:block></fo:block></fo:block><fo:block id="_calcul_de_emphasis_m_emphasis_2"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Calcul de <fo:inline font-style="italic">M'</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons calculer <fo:inline font-style="italic">M'</fo:inline> en deux étapes :</fo:block><fo:list-block id="idm45336283207392" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283206416" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Extraction de tbsCertificate du certificat <fo:inline font-style="italic">letsencrypt.org</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283205264" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Calcul du hash SHA-256 de tbsCertificate.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Mais avant d’extraire tbsCertificate, nous devons comprendre comment le certificat est structuré et codé.</fo:block><fo:block id="_asn_1_et_der"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">ASN.1 et DER</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au début de ce document, nous avons observé que la section 4.1 de la RFC 5280, qui définit la structure des certificats x509 v3, contient cette définition :</fo:block><fo:block id="idm45336283202048" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">Certificate  ::=  SEQUENCE  {
        tbsCertificate       TBSCertificate,
        signatureAlgorithm   AlgorithmIdentifier,
        signatureValue       BIT STRING  }</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un certificat x509 est défini selon la syntaxe ASN.1.
L’encodage peut être BER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">8</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">8</fo:inline>BER signifie <fo:inline font-weight="bold">B</fo:inline>asic <fo:inline font-weight="bold">E</fo:inline>ncoding <fo:inline font-weight="bold">R</fo:inline>ules</fo:block></fo:footnote-body></fo:footnote>
, CER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">9</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">9</fo:inline>CER signifie <fo:inline font-weight="bold">C</fo:inline>anonical <fo:inline font-weight="bold">E</fo:inline>ncoding <fo:inline font-weight="bold">R</fo:inline>ules</fo:block></fo:footnote-body></fo:footnote>
ou DER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">10</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">10</fo:inline>DER signifie <fo:inline font-weight="bold">D</fo:inline>istinguished <fo:inline font-weight="bold">E</fo:inline>ncoding <fo:inline font-weight="bold">R</fo:inline>ules</fo:block></fo:footnote-body></fo:footnote>
.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ces trois standards sont très proches, l’intérêt de DER étant son unicité : une structure de données spécifiée en ASN.1 ne peut être encodée en DER que d’une manière, et une seule. BER et CER permettent certaines variations dans la manière d’encoder.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour ne pas alourdir la rédaction, nous parlerons toujours d’encodage DER ou simplement DER, même lorsque les données manipulées pourraient ne pas être DER
<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">11</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">11</fo:inline>La RFC 5280 indique que les <fo:inline font-style="italic">données signées</fo:inline> d’un certificat (la partie tbsCertificate) doivent être encodées en DER, mais ne donne pas d’indication pour le reste.</fo:block></fo:footnote-body></fo:footnote>
.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">ASN.1 structure chaque valeur (<fo:inline font-style="italic">data value</fo:inline> dans le document X.690) selon la typologie <fo:inline font-weight="bold">T</fo:inline> - <fo:inline font-weight="bold">L</fo:inline> - <fo:inline font-weight="bold">V</fo:inline> ou <fo:inline font-weight="bold">T</fo:inline>ag - <fo:inline font-weight="bold">L</fo:inline>ength - <fo:inline font-weight="bold">V</fo:inline>alue.
La forme "longueur indéfinie" apporte un quatrième élément, "end-of-contents" (marqueur de fin de valeur), que nous ignorerons car DER ne permet pas cette forme.</fo:block><fo:list-block id="idm45336283185456" provisional-distance-between-starts="10em * 0.60+1em" provisional-label-separation="1em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em"><fo:list-item id="idm45336283185200" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
[<fo:inline font-weight="bold">T</fo:inline>]ag
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Définit toutes les caractéristiques de la valeur, notamment son <fo:inline font-style="italic">type</fo:inline>, par exemple une date (<fo:inline font-style="italic">UTCTime</fo:inline>), une séquence (<fo:inline font-style="italic">SEQUENCE</fo:inline> ou <fo:inline font-style="italic">SEQUENCE OF</fo:inline>), un entier (<fo:inline font-style="italic">INTEGER</fo:inline>), et bien d’autres. Il définit également si l’encodage de la valeur est <fo:inline font-style="italic">primitive</fo:inline> ou <fo:inline font-style="italic">contructed</fo:inline>.
</fo:block><fo:list-block id="idm45336283180336" provisional-distance-between-starts="24em * 0.60+1em" provisional-label-separation="1em"><fo:list-item id="idm45336283180080" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Encodage <fo:inline font-style="italic">primitive</fo:inline>
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La donnée ne contient pas de sous-structure
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283178048" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Encodage <fo:inline font-style="italic">constructed</fo:inline>
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La donnée est elle-même une structure qui suit la typologie <fo:inline font-weight="bold">T</fo:inline>-<fo:inline font-weight="bold">L</fo:inline>-<fo:inline font-weight="bold">V</fo:inline>, et ici, cette structure est elle-même définie en ASN.1 <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">12</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">12</fo:inline>Certains types de données, notamment les <fo:inline font-style="italic">*string</fo:inline> (OCTET STRING, UTF8String, etc.), peuvent être <fo:inline font-style="italic">primitive</fo:inline> ou <fo:inline font-style="italic">constructed</fo:inline>, ce qui signifie que leur encodage peut suivre une structure hiérarchique "propre à l’encodage", non explicitée dans la définition de la valeur en ASN.1.</fo:block></fo:footnote-body></fo:footnote>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283171920" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Structure hiérarchique
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La différence <fo:inline font-style="italic">primitive</fo:inline> - <fo:inline font-style="italic">constructed</fo:inline> est à la base de la structure hiérarchique d’une spécification ASN.1, les éléments <fo:inline font-style="italic">constructed</fo:inline> étant les branches, les éléments <fo:inline font-style="italic">primitive</fo:inline> étant les feuilles.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans la définition d’un <fo:inline font-style="italic">Certificate</fo:inline> ci-dessus, le type <fo:inline font-style="italic">SEQUENCE</fo:inline> est, par définition du type <fo:inline font-style="italic">SEQUENCE</fo:inline> en ASN.1, <fo:inline font-style="italic">constructed</fo:inline>. Cela signifie que la valeur <fo:inline font-style="italic">SEQUENCE</fo:inline> est elle-même une structure ASN.1, ce qu’on peut voir dans la liste des trois composants d’un certificat définie entre accolades.</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283165584" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
[<fo:inline font-weight="bold">L</fo:inline>]ength
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Donne la longueur de la valeur en octets.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283163328" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
[<fo:inline font-weight="bold">V</fo:inline>]alue
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Est la donnée elle-même. Dans ce document nous employons le terme <fo:inline font-style="italic">valeur</fo:inline> (dans le document X.690 le terme est <fo:inline font-style="italic">data value</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Affichons le contenu DER avec l’utilitaire en ligne de commande <fo:inline font-style="italic">dder</fo:inline> en exécutant la commande suivante :</fo:block><fo:block id="idm45336283159184" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ dder -width 8 -recursive "|  " m.der</fo:block><fo:block id="idm45336283158560" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 18.  </fo:block><fo:block id="idm45336283157808"><fo:external-graphic src="url(./images/img-dder-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La copie d'écran de la figure 18 a été faite sous Windows pour changer un peu.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La description de la valeur indique <fo:inline font-style="italic">-cons</fo:inline> ou <fo:inline font-style="italic">-prim</fo:inline>, pour <fo:inline font-style="italic">constructed</fo:inline> ou <fo:inline font-style="italic">primitive</fo:inline>.
Chaque fois que le tag indique une valeur <fo:inline font-style="italic">constructed</fo:inline> (ici, il s’agit à deux reprises du type <fo:inline font-style="italic">SEQUENCE</fo:inline>, qui est obligatoirement <fo:inline font-style="italic">constructed</fo:inline>), on descend d’un niveau dans la structure hiérarchique, que l’on a fait ressortir ici avec l’option <fo:inline font-style="italic">-recursive "|  "</fo:inline>.</fo:block></fo:block><fo:block id="_extraction_de_tbscertificate_du_certificat_emphasis_letsencrypt_org_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Extraction de tbsCertificate du certificat <fo:inline font-style="italic">letsencrypt.org</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_&#xE9;tape_1_de_l_8217_extraction"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Étape 1 de l’extraction</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Commençons par enregistrer le certificat depuis le navigateur, dans le fichier <fo:inline font-style="italic">letsencryptorg.der</fo:inline>.</fo:block><fo:block><fo:block id="idm45336283147888" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 7. Firefox</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Afficher le certificat comme vu précédemment, puis afficher l’onglet <fo:inline font-style="italic">Détails</fo:inline> et cliquer sur le bouton <fo:inline font-style="italic">Exporter</fo:inline>.
Ensuite sélectionner <fo:inline font-style="italic">Certificat X.509 (DER)</fo:inline>.</fo:block><fo:block id="idm45336283145568" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 19.  </fo:block><fo:block id="idm45336283144928"><fo:external-graphic src="url(./images/img-certsave-ff-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45336283142896" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 8. Internet Explorer et Chrome</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Afficher le certificat, puis cliquer sur le bouton <fo:inline font-style="italic">Copier dans un fichier…</fo:inline>.
Ensuite sélectionner <fo:inline font-style="italic">X.509 binaire encodé DER</fo:inline>.</fo:block><fo:block id="idm45336283141008" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 20.  </fo:block><fo:block id="idm45336283140256"><fo:external-graphic src="url(./images/img-certsave-ie-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45336283138224" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">PEM versus DER</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Avec les certificats x509, l’encodage PEM est une surcouche de DER qui consiste à :</fo:block><fo:list-block id="idm45336283136960" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283136704" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Encoder le contenu binaire (après chiffrement éventuel) en BASE64
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283135776" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Ajouter au début et à la fin un texte standardisé qui définit et délimite la nature du contenu, ainsi que les informations de chiffrement s’il y a lieu
</fo:block><fo:list-block id="idm45336283134832" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283134576" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La ligne ajoutée au début commence par <fo:inline font-weight="bold"><fo:inline font-family="monospace">-----BEGIN</fo:inline></fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283132720" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La ligne ajoutée à la fin commence par <fo:inline font-weight="bold"><fo:inline font-family="monospace">-----END</fo:inline></fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Si vous avez enregistré le certificat avec un encodage PEM, vous pouvez le convertir en DER avec <fo:inline font-style="italic">openssl</fo:inline>. Exemple pour <fo:inline font-style="italic">letsencrypt.cer</fo:inline> (PEM) que l’on convertit en <fo:inline font-style="italic">letsencrypt.der</fo:inline> (DER)  - comme on peut voir, l’encodage par défaut avec <fo:inline font-style="italic">openssl</fo:inline> est PEM.</fo:block><fo:block id="idm45336283128256" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl x509 -in letsencryptorg.cer -outform der -out letsencryptorg.der</fo:block><fo:block id="idm45336283127536" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 21.  </fo:block><fo:block id="idm45336283126784"><fo:external-graphic src="url(./images/img-pem-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283124880" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 22.  </fo:block><fo:block id="idm45336283124128"><fo:external-graphic src="url(./images/img-convpemder-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Vous pouvez faire cette conversion "à la main" en enlevant la première et la dernière ligne et en faisant une conversion BASE64 → binaire avec des outils comme <fo:inline font-style="italic">base64</fo:inline> (Linux) ou <fo:inline font-style="italic">notepad++</fo:inline> (Windows).</fo:block></fo:block></fo:block></fo:block><fo:block id="_&#xE9;tape_2_de_l_8217_extraction"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Étape 2 de l’extraction</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous disposons maintenant d’un certificat enregistré en binaire (encodage DER) dans le fichier <fo:inline font-style="italic">letsencryptorg.der</fo:inline>, dont nous allons à présent extraire la partie tbsCertificate.</fo:block><fo:block id="idm45336283118416" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les outils <fo:inline font-style="italic">dder</fo:inline> et <fo:inline font-style="italic">pkfile</fo:inline> (<fo:inline font-style="italic">pkfile</fo:inline> est présenté plus loin) peuvent lire indifféremment des fichiers codés en PEM ou en DER. Si le fichier est PEM, il est décodé à la volée.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Il y a deux solutions pour ce faire</fo:block><fo:list-block id="idm45336283115808" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283114944" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
À la main
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283114176" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
À l’aide de l’utilitaire <fo:inline font-style="italic">pkfile</fo:inline>. <fo:inline font-style="italic">pkfile</fo:inline> est disponible à cette URL <fo:basic-link internal-destination="12"><fo:inline>[12]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Extraction de tbsCertificate : alernative 1 (à la main). </fo:inline>Un éditeur de fichier binaire ferait l’affaire, mais la manipulation est plus claire si l’on affiche le contenu hexadécimal avec <fo:inline font-style="italic">dder</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter la commande</fo:block><fo:block id="idm45336283110048" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ dder -recursive "|  " -hex letsencryptorg.der &gt; d</fo:block><fo:block id="idm45336283109312" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Encodage des fichiers affichés par dder</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">dder</fo:inline> lit indifféremment des fichiers PEM et DER. Si le fichier est PEM il décode (et décrypte si nécessaire) les données en mémoire avant d’afficher le contenu DER.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Donc la commande aurait pu être (avec le fichier <fo:inline font-style="italic">letsencryptorg.cer</fo:inline> encodé en PEM) :</fo:block><fo:block id="idm45336283106752" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ dder -recursive "|  " -hex letsencryptorg.cer &gt; d</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ouvrir le fichier <fo:inline font-style="italic">d</fo:inline> dans un éditeur de texte.
Comme on a affiché le contenu avec un décalage à chaque niveau hiérarchique (option <fo:inline font-style="italic">-recursive "|  "</fo:inline>), la structure en trois parties des certificats x509 ressort bien.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Supprimer les deux premières lignes et un certain nombre de lignes à la fin pour que seul demeure le contenu de tbsCertificate. Ci-dessous, le texte à conserver est le texte sélectionné (les lignes au milieu ont été supprimées pour condenser l’image).</fo:block><fo:block id="idm45336283103504" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 23.  </fo:block><fo:block id="idm45336283102752"><fo:external-graphic src="url(./images/img-extracttbs-alt1-1.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283100848" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 24.  </fo:block><fo:block id="idm45336283100096"><fo:external-graphic src="url(./images/img-extracttbs-alt1-2-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ensuite :</fo:block><fo:list-block id="idm45336283097808" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283097552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer les "|" en début de ligne
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283096688" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer l’offset (numéro sur six caractères)
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283095792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer le texte après les codes hexadécimaux (une fois supprimé les "|" et l’offset en début de ligne, ce sont tous les caractères au-delà de la 55e position qu’il faut supprimer).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283094528" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Supprimer tous les espaces
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336283093552" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 25.  </fo:block><fo:block id="idm45336283092800"><fo:external-graphic src="url(./images/img-extracttbs-alt1-3-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">On retrouve (figure 25) une sous-partie du fichier <fo:inline font-style="italic">letsencryptorg.der</fo:inline>, codée en hexadécimal, qui commence par <fo:inline font-weight="bold"><fo:inline font-family="monospace">308205ea</fo:inline></fo:inline> et se termine par <fo:inline font-weight="bold"><fo:inline font-family="monospace">2e6f7267</fo:inline></fo:inline>.</fo:block><fo:block id="idm45336283088048" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cette manipulation peut être faite avec un programme d'édition de fichier binaire, en ne gardant que les données à partir de l’offset 4, d’une longueur de 1518 octets.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Il faut ensuite convertir le contenu "codé hexadécimal" en binaire comme cela a été vu précédemment (commande <fo:inline font-style="italic">xxd -r -p</fo:inline> sous Linux, avec <fo:inline font-style="italic">notepad++</fo:inline> sous Windows).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au final on obtient le fichier <fo:inline font-style="italic">tbs.der</fo:inline> comme montré sur la figure 26.</fo:block><fo:block id="idm45336283084752" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 26.  </fo:block><fo:block id="idm45336283084000"><fo:external-graphic src="url(./images/img-extracttbs-alt1-4-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Extraction de tbsCertificate : alernative 2 (à l’aide de <fo:inline font-style="italic">pkfile</fo:inline>). </fo:inline>Exécuter la commande</fo:block><fo:block id="idm45336283080864" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ pkfile letsencryptorg.der -l 2</fo:block><fo:block id="idm45336283080240" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 27.  </fo:block><fo:block id="idm45336283079488"><fo:external-graphic src="url(./images/img-extracttbs-alt2-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le résultat visible sur la figure 27 nous montre que le tbsCertificate correspond à la valeur <fo:inline font-style="italic">SEQUENCE</fo:inline> de 1518 octets (4 octets d’en-tête, 1514 octets de données). <fo:inline font-style="italic">pkfile</fo:inline> donne à cette valeur les coordonnées 1.1.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous enregistrons cette valeur en binaire dans le fichier <fo:inline font-style="italic">tbs2.der</fo:inline> en exécutant la commande</fo:block><fo:block id="idm45336283075056" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ pkfile letsencryptorg.der -n 1.1 -x -o tbs2.der</fo:block><fo:block id="idm45336283074432" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 28.  </fo:block><fo:block id="idm45336283073680"><fo:external-graphic src="url(./images/img-extracttbs-alt2-2.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283071776" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Encodage des fichiers analysés par pkfile</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">pkfile</fo:inline> lit indifféremment des fichiers PEM et DER. Si le fichier est PEM il décode (et décrypte si nécessaire) les données en mémoire avant de traiter le contenu DER.</fo:block></fo:block></fo:block></fo:block><fo:block id="_calcul_du_hash_de_tbscertificate"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Calcul du hash de tbsCertificate</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45336283068912" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 9. Linux</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le calcul des différents algorithmes de hash est disponible en ligne de commande. Pour SHA-256 le programme est <fo:inline font-style="italic">sha256sum</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exécuter</fo:block><fo:block id="idm45336283066880" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ sha256sum tbs.der</fo:block><fo:block id="idm45336283066256" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 29.  </fo:block><fo:block id="idm45336283065504"><fo:external-graphic src="url(./images/img-calchash-1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block><fo:block id="idm45336283063472" keep-together.within-column="auto" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Example 10. Windows</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Lels outils de calcul de hash ne sont pas disponibles par défaut. Voici quelques solutions (d’autres existent) :</fo:block><fo:list-block id="idm45336283062240" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283061984" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Utiliser <fo:inline font-style="italic">pkfile</fo:inline>, qui permet de calculer différents hash<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">13</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">13</fo:inline><fo:inline font-style="italic">pkfile</fo:inline> peut le faire aussi sous Linux, mais dans ce système il est plus logique d’utiliser les programmes déjà installés. La fonctionnalité de calcul de hash a été ajoutée à <fo:inline font-style="italic">pkfile</fo:inline> pour simplifier les manipulations sous Windows.</fo:block></fo:footnote-body></fo:footnote>
.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283059104" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Installer les outils <fo:inline font-style="italic">GNUWin32</fo:inline>, disponibles à cette URL <fo:basic-link internal-destination="13"><fo:inline>[13]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283057456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
7-ZIP ajoute des menus contextuels dans l’explorateur pour calculer différents hashs, dont SHA-256. 7-ZIP est disponible à cette URL <fo:basic-link internal-destination="14"><fo:inline>[14]</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Exemple avec <fo:inline font-style="italic">pkfile</fo:inline>, exécuter</fo:block><fo:block id="idm45336283054976" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ pkfile --sha256 tbs.der</fo:block><fo:block id="idm45336283054352" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 30.  </fo:block><fo:block id="idm45336283053600"><fo:external-graphic src="url(./images/img-calchash-2.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336283051696" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 31.  </fo:block><fo:block id="idm45336283050944"><fo:external-graphic src="url(./images/img-calchash-3.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les captures d'écran montrent également le calcul sur le fichier <fo:inline font-style="italic">tbs2.der</fo:inline> (créé avec <fo:inline font-style="italic">pkfile</fo:inline>), qui est ben identique à <fo:inline font-style="italic">tbs.der</fo:inline>, ce qui confirme au passage l'équivalence des deux termes de l’alternative pour extraire tbsCertificate.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold">Le hash trouvé (<fo:inline font-style="normal">M'</fo:inline>) concorde avec la signature (<fo:inline font-style="normal">M</fo:inline>), ce qui valide la signature du certificat <fo:inline font-style="normal">letsencrypt.org</fo:inline></fo:inline></fo:block></fo:block></fo:block></fo:block><fo:block id="_conclusion"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Conclusion</fo:marker><fo:block font-size="17.28pt">Conclusion</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous arrivons au terme des manipulations à effectuer pour vérifier la signature RSA d’un certificat x509. Les calculs étaient élémentaires, mais cela nous a permis de voir :</fo:block><fo:list-block id="idm45336283043104" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283042848" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les différents formats et encodages et les outils pour passer de l’un à l’autre
</fo:block><fo:list-block id="idm45336283042048" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283041792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
PEM versus DER
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283041024" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
BASE64 versus binaire
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283040256" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Hexadécimal versus binaire
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283039408" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
ASN.1
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283038640" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La structure de certificat x509
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283037536" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les solutions pour calculer sur des entiers de grande taille
</fo:block><fo:list-block id="idm45336283036752" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283036496" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">python</fo:inline> (évoqué ici mais non détaillé) et <fo:inline font-style="italic">bc</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283034864" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les transformations éventuelles et précautions à prendre pour calculer en saisie et affichage hexadécimal
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283033856" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La création de la fonction <fo:inline font-style="italic">powmod</fo:inline> dans <fo:inline font-style="italic">bc</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283031984" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Outils divers
</fo:block><fo:list-block id="idm45336283031344" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336283031088" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Calcul du hash d’un fichier
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283030320" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Extraction d’une valeur d’un fichier encodé en DER
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La <fo:inline font-style="italic">signature</fo:inline> a été vérifiée mais le certificat lui-même n’a pas été validé en totalité. Il y a deux raisons à cela.</fo:block><fo:list-block id="idm45336283027952" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336283026976" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Une fois un certificat vérifié, il faut vérifier son parent dans la hiérarchie (le certificat qui l’a signé), et ainsi de suite, jusqu'à vérifier un certificat connu dans la base des certificats du navigateur (les certificats <fo:inline font-style="italic">racine</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283025136" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le navigateur vérifie si les certificats rencontrés ont été révoqués à l’aide des Listes de Révocation des Certificats ou <fo:inline font-style="italic">CRL</fo:inline> (<fo:inline font-style="italic"><fo:inline font-weight="bold">C</fo:inline>ertificate <fo:inline font-weight="bold">R</fo:inline>evocation <fo:inline font-weight="bold">L</fo:inline>ist</fo:inline>).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/></fo:block></fo:block><fo:block id="_v&#xE9;rification_de_signature_ecdsa"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Vérification de signature ECDSA</fo:marker><fo:block font-size="20.736pt">Vérification de signature ECDSA</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_cryptographie_&#xE0;_courbes_elliptiques"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Cryptographie à courbes elliptiques</fo:marker><fo:block font-size="17.28pt">Cryptographie à courbes elliptiques</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ce document se concentre sur les problématiques de calcul effectif et de formats de fichiers.
Nous n’allons pas expliquer ici toute la cryptographie à base de courbes elliptiques, nous allons simplement en résumer les grandes lignes, donner les formules applicables et quelques définitions.</fo:block><fo:block id="_les_deux_familles_de_courbes_elliptiques"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Les deux familles de courbes elliptiques</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45336283017008" provisional-distance-between-starts="24em * 0.60+1em" provisional-label-separation="1em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em"><fo:list-item id="idm45336283016752" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Les courbes sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline></fo:inline> (<fo:inline font-style="italic">binary field</fo:inline>)
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Cette notation est un raccourci. On a <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">n</fo:inline></fo:inline> = F<fo:inline font-size="75%" baseline-shift="sub">2</fo:inline>[x]/(p(x))</fo:inline> où <fo:inline font-style="italic">p(x)</fo:inline> est un polynôme irréductible de degré <fo:inline font-style="italic">n</fo:inline> (source : <fo:basic-link internal-destination="15"><fo:inline>[15]</fo:inline></fo:basic-link>). Les "nombres" manipulés sont des polynômes sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2</fo:inline></fo:inline> et les opérations sont faites modulo <fo:inline font-style="italic">p(x)</fo:inline>. L'équation de la courbe (source : <fo:basic-link internal-destination="16"><fo:inline>[16]</fo:inline></fo:basic-link>) est
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="super">2</fo:inline> + xy = x<fo:inline font-size="75%" baseline-shift="super">3</fo:inline> + ax<fo:inline font-size="75%" baseline-shift="super">2</fo:inline> + b</fo:inline></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les opérations sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline></fo:inline> portent sur des polynômes et leur arithmétique est distincte de l’arithmétique usuelle sur les nombres entiers. Par exemple quel que soit <fo:inline font-style="italic">A</fo:inline> de <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline></fo:inline>, on a <fo:inline font-style="italic">A + A = 0</fo:inline> (soit <fo:inline font-style="italic">A = -A</fo:inline> pour tout <fo:inline font-style="italic">A</fo:inline>).</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336283003536" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
Les courbes sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline> (<fo:inline font-style="italic">prime field</fo:inline>)
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">p</fo:inline> est un nombre premier. On a <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline> = Z/pZ</fo:inline> (source : <fo:basic-link internal-destination="17"><fo:inline>[17]</fo:inline></fo:basic-link>). Les opérations sont faites modulo <fo:inline font-style="italic">p</fo:inline>. L'équation de la courbe est (source : <fo:basic-link internal-destination="16"><fo:inline>[16]</fo:inline></fo:basic-link>)
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="super">2</fo:inline> = x<fo:inline font-size="75%" baseline-shift="super">3</fo:inline> + ax + b</fo:inline></fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="_les_param&#xE8;tres_de_domaine"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Les paramètres de domaine</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ces paramètres définissent les caractéristiques de la courbe. Une clé est définie pour une courbe et une seule, la courbe étant entièrement déterminée par ses paramètres de domaine. On parle aussi de paramètres de la courbe.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Source : <fo:basic-link internal-destination="16"><fo:inline>[16]</fo:inline></fo:basic-link>.</fo:block><fo:list-block id="idm45336282994096" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336282993840" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline></fo:inline>, les paramètres sont (<fo:inline font-style="italic">m</fo:inline>, <fo:inline font-style="italic">f(x)</fo:inline>, <fo:inline font-style="italic">a</fo:inline>, <fo:inline font-style="italic">b</fo:inline>, <fo:inline font-style="italic">G</fo:inline>, <fo:inline font-style="italic">n</fo:inline>, <fo:inline font-style="italic">h</fo:inline>)
</fo:block><fo:list-block id="idm45336282989616" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336282989360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">m</fo:inline>, entier qui définit <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline></fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282987312" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">f(x)</fo:inline>, polynôme irréductible de degré <fo:inline font-style="italic">m</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282985680" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">a</fo:inline> et <fo:inline font-style="italic">b</fo:inline>, les paramètres de l'équation <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="super">2</fo:inline> + xy = x<fo:inline font-size="75%" baseline-shift="super">3</fo:inline> + ax<fo:inline font-size="75%" baseline-shift="super">2</fo:inline> + b</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282982528" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">G</fo:inline>, le générateur du groupe noté <fo:inline font-style="italic">E(F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline>)</fo:inline> (<fo:inline font-style="italic">G</fo:inline> est donc un point de la courbe).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282979808" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">n</fo:inline> est l’ordre du groupe généré par <fo:inline font-style="italic">G</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282978176" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">h</fo:inline> est le cofacteur, c’est le nombre d'éléments de <fo:inline font-style="italic">E(F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline>)</fo:inline> divisé par <fo:inline font-style="italic">n</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282975216" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline>, les paramètres sont (<fo:inline font-style="italic">p</fo:inline>, <fo:inline font-style="italic">a</fo:inline>, <fo:inline font-style="italic">b</fo:inline>, <fo:inline font-style="italic">G</fo:inline>, <fo:inline font-style="italic">n</fo:inline>, <fo:inline font-style="italic">h</fo:inline>)
</fo:block><fo:list-block id="idm45336282971632" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336282971376" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">p</fo:inline>, nombre premier.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282970224" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">a</fo:inline> et <fo:inline font-style="italic">b</fo:inline>, les paramètres de l'équation <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="super">2</fo:inline> (mod p) = x<fo:inline font-size="75%" baseline-shift="super">3</fo:inline> + ax + b (mod p)</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282967456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">G</fo:inline>, le générateur du groupe noté <fo:inline font-style="italic">E(F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline>)</fo:inline> (<fo:inline font-style="italic">G</fo:inline> est donc un point de la courbe).
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282964992" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">n</fo:inline> est l’ordre du groupe généré par <fo:inline font-style="italic">G</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282963360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">h</fo:inline> est le cofacteur, c’est le nombre d'éléments de <fo:inline font-style="italic">E(F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline>)</fo:inline> divisé par <fo:inline font-style="italic">n</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Les courbes nommées. </fo:inline>Toute information pratique sur les courbes elliptiques (clé privée ou publique, signature…) n’est exploitable qu’avec les paramètres de domaine de la courbe elliptique utilisée.
Les paramètres de domaine peuvent être donnés de deux manières : tels quels (les différents éléments vus précédemment et qui définissent une courbe, tels que <fo:inline font-style="italic">a</fo:inline>, <fo:inline font-style="italic">b</fo:inline>, <fo:inline font-style="italic">G</fo:inline>, etc.), ou bien sous la forme d’une <fo:inline font-style="italic">courbe nommée</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">openssl</fo:inline> peut lister les courbes nommées :</fo:block><fo:block id="idm45336282956800" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl ecparam -list_curves
  secp112r1 : SECG/WTLS curve over a 112 bit prime field
  secp112r2 : SECG curve over a 112 bit prime field
  [...]
  brainpoolP512r1: RFC 5639 curve over a 512 bit prime field
  brainpoolP512t1: RFC 5639 curve over a 512 bit prime field</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">La commande suivante permet d’afficher les détails d’une courbe, exemple avec <fo:inline font-style="italic">secp256r1</fo:inline> :</fo:block><fo:block id="idm45336282954480" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl ecparam -name secp256r1 -noout -text
using curve name prime256v1 instead of secp256r1
ASN1 OID: prime256v1
NIST CURVE: P-256</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">openssl</fo:inline> nous avertit que <fo:inline font-style="italic">secp256r1</fo:inline> (définition "SECG" : <fo:basic-link internal-destination="18"><fo:inline>[18]</fo:inline></fo:basic-link>) est en fait la courbe <fo:inline font-style="italic">NIST P-256</fo:inline> (définie ici <fo:basic-link internal-destination="19"><fo:inline>[19]</fo:inline></fo:basic-link>), qui porte le nom <fo:inline font-style="italic">prime256v1</fo:inline> dans le standard <fo:inline font-style="italic">X9.62</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Tout ça pour dire quoi ? Rien, à part que l’on peut se féliciter de vivre à l’heure d’Internet pour s’y retrouver dans la jungle des documents de normalisation.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Et les paramètres de domaine ? Il faut demander à <fo:inline font-style="italic">openssl</fo:inline> d’afficher les paramètres de la courbe sous forme explicite :</fo:block><fo:block id="idm45336282948544" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl ecparam -name secp256r1 -noout -text -param_enc explicit
using curve name prime256v1 instead of secp256r1
Field Type: prime-field
Prime:
    00:ff:ff:ff:ff:00:00:00:01:00:00:00:00:00:00:
    00:00:00:00:00:00:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:ff
A:
    00:ff:ff:ff:ff:00:00:00:01:00:00:00:00:00:00:
    00:00:00:00:00:00:ff:ff:ff:ff:ff:ff:ff:ff:ff:
    ff:ff:fc
B:
    5a:c6:35:d8:aa:3a:93:e7:b3:eb:bd:55:76:98:86:
    bc:65:1d:06:b0:cc:53:b0:f6:3b:ce:3c:3e:27:d2:
    60:4b
Generator (uncompressed):
    04:6b:17:d1:f2:e1:2c:42:47:f8:bc:e6:e5:63:a4:
    40:f2:77:03:7d:81:2d:eb:33:a0:f4:a1:39:45:d8:
    98:c2:96:4f:e3:42:e2:fe:1a:7f:9b:8e:e7:eb:4a:
    7c:0f:9e:16:2b:ce:33:57:6b:31:5e:ce:cb:b6:40:
    68:37:bf:51:f5
Order:
    00:ff:ff:ff:ff:00:00:00:00:ff:ff:ff:ff:ff:ff:
    ff:ff:bc:e6:fa:ad:a7:17:9e:84:f3:b9:ca:c2:fc:
    63:25:51
Cofactor:  1 (0x1)
Seed:
    c4:9d:36:08:86:e7:04:93:6a:66:78:e1:13:9d:26:
    b7:81:9f:7e:90</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Tous ces paramètres ont été vus plus haut, sauf <fo:inline font-style="italic">Seed</fo:inline>. Qu’en est-il ?</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">Seed</fo:inline> est un nombre arbitraire à partir duquel les autres paramètres de la courbe ont été déterminés, de manière vérifiable par n’importe qui, selon une spécification <fo:inline font-style="italic">X9.62</fo:inline>. Cela garantit qu’ils n’ont pas été choisis en raison de propriétés cachées qui permettraient à leur inventeur de casser la protection facilement. <fo:inline font-style="italic">Seed</fo:inline> est à l’origine des paramètres de la courbe mais il n’en fait pas partie. Le passage de <fo:inline font-style="italic">Seed</fo:inline> aux paramètres utilise une fonction de hachage à sens unique, ce qui garantit que le choix ne s’est pas fait dans l’autre sens (détermination de paramètres ad hoc puis du <fo:inline font-style="italic">Seed</fo:inline> correspondant).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Le x509. </fo:inline>La RFC 5480 (<fo:basic-link internal-destination="20"><fo:inline>[20]</fo:inline></fo:basic-link>) interdit expressément l’usage de paramètres explicites dans le standard x509, seules les courbes nommées peuvent y être utilisées.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons maintenant nous intéresser aux courbes sur les corps premiers (<fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline>).
Les courbes binaires fonctionnent selon les mêmes principes mais les "nombres" manipulés sont des polynômes sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2</fo:inline></fo:inline>, et si l’on souhaite y mener des calculs avec <fo:inline font-style="italic">bc</fo:inline> ou <fo:inline font-style="italic">python</fo:inline>, cela nécessite de coder spécifiquement leur arithmétique. Dans ce document nous ferons des calculs sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline> uniquement.</fo:block></fo:block><fo:block id="_l_8217_arithm&#xE9;tique_des_courbes_sur_emphasis_f_subscript_p_subscript_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">L’arithmétique des courbes sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les calculs sont faits modulo <fo:inline font-style="italic">p</fo:inline> et nous ne le préciserons plus par la suite <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">14</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">14</fo:inline>Dans la signature ECDSA certains calculs sont faits modulo <fo:inline font-style="italic">n</fo:inline>, l’ordre du groupe associé à la courbe. Cela sera signalé. À défaut, tous les calculs sont faits modulo <fo:inline font-style="italic">p</fo:inline>.</fo:block></fo:footnote-body></fo:footnote>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Clés privée et publique. </fo:inline>La construction d’une paire de clés privée et publique consiste à</fo:block><fo:list-block id="idm45336282931296" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336282930320" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Choisir un entier <fo:inline font-style="italic">k</fo:inline> inférieur à <fo:inline font-style="italic">p</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282928784" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Calculer <fo:inline font-style="italic">Q = kG</fo:inline> où <fo:inline font-style="italic">G</fo:inline> est l’un des paramètres de domaine de la courbe (voir ci-après la multiplication d’un point par un scalaire)
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le point <fo:inline font-style="italic">Q</fo:inline> est la clé publique, l’entier <fo:inline font-style="italic">k</fo:inline> est la clé privée. Ainsi contrairement au RSA où la clé privée et publique ont même nature (ce sont deux entiers), ici la clé publique est un point tandis que la clé privée est un entier.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Addition de deux points distincts (et non alignés verticalement). </fo:inline>La signification de l’addition de deux points est géométrique et on peut le voir ici <fo:basic-link internal-destination="21"><fo:inline>[21]</fo:inline></fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Les formules qui en découlent sont les suivantes, pour <fo:inline font-style="italic">R = P + Q</fo:inline> de coordonnées (<fo:inline font-style="italic">r<fo:inline font-size="75%" baseline-shift="sub">x</fo:inline></fo:inline>, <fo:inline font-style="italic">r<fo:inline font-size="75%" baseline-shift="sub">y</fo:inline></fo:inline>), (<fo:inline font-style="italic">p<fo:inline font-size="75%" baseline-shift="sub">x</fo:inline></fo:inline>, <fo:inline font-style="italic">p<fo:inline font-size="75%" baseline-shift="sub">y</fo:inline></fo:inline>) et (<fo:inline font-style="italic">q<fo:inline font-size="75%" baseline-shift="sub">x</fo:inline></fo:inline>, <fo:inline font-style="italic">q<fo:inline font-size="75%" baseline-shift="sub">y</fo:inline></fo:inline>) respectivement, <fo:inline font-style="italic">P</fo:inline> étant différent de Q et non aligné verticalement avec <fo:inline font-style="italic">Q</fo:inline> :</fo:block><fo:block id="idm45336282918064" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block id="idm45336282917568"><fo:external-graphic src="url(./images/img-point-add.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Addition d’un point avec lui-même. </fo:inline>Pour <fo:inline font-style="italic">P = Q</fo:inline>, le calcul de <fo:inline font-style="italic">R = P + P = 2P</fo:inline> est (en reprenant les notations précédentes) :</fo:block><fo:block id="idm45336282913904" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block id="idm45336282913408"><fo:external-graphic src="url(./images/img-point-dbl.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block id="idm45336282911504" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Important</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le symbole de fraction n’est pas la division euclidienne mais la multiplication par l’inverse modulo <fo:inline font-style="italic">p</fo:inline>.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Multiplication d’un point par un entier naturel. </fo:inline>Avec les formules qui précèdent, on sait calculer <fo:inline font-style="italic">P + P = 2P</fo:inline>, <fo:inline font-style="italic">P + 2P = 3P</fo:inline>, et ainsi de suite.
On sait donc calculer <fo:inline font-style="italic">kP</fo:inline>, <fo:inline font-style="italic">k</fo:inline> entier.</fo:block><fo:block id="idm45336282907680" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Addition de deux points alignés verticalement</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Si <fo:inline font-style="italic">P</fo:inline> et <fo:inline font-style="italic">Q</fo:inline> sont alignés verticalement ils sont opposés (cela découle du terme <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="super">2</fo:inline></fo:inline> de l'équation), on a donc <fo:inline font-style="italic">P = -Q</fo:inline> que l’on peut aussi écrire <fo:inline font-style="italic">P + Q = O</fo:inline>. <fo:inline font-style="italic">O</fo:inline> est le "point à l’infini" de la courbe elliptique et il joue le même rôle que zéro dans l’addition des entiers. Ainsi on a <fo:inline font-style="italic">P + O = O + P = O</fo:inline> quel que soit <fo:inline font-style="italic">P</fo:inline> sur la courbe.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Multiplication par un entier <fo:inline font-style="italic">k</fo:inline> très grand. </fo:inline>Les <fo:inline font-style="italic">k</fo:inline> utilisés en pratique étant des grands nombres (de l’ordre de 2<fo:inline font-size="75%" baseline-shift="super">256</fo:inline> avec <fo:inline font-style="italic">prime256v1</fo:inline>), il n’est pas possible de calculer <fo:inline font-style="italic">kP</fo:inline> en ajoutant <fo:inline font-style="italic">P</fo:inline> à lui-même <fo:inline font-style="italic">k</fo:inline> fois.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Il faut utiliser l’algorithme d’exponentiation rapide vu précédemment : <fo:basic-link internal-destination="9"><fo:inline>[9]</fo:inline></fo:basic-link>.
Remplacer la multiplication de deux entiers par l’addition de deux points et l'élévation à la puissance par la multiplication d’un point par un entier.</fo:block></fo:block><fo:block id="_fonctions_de_calcul_sur_emphasis_f_subscript_p_subscript_emphasis_avec_le_programme_emphasis_bc_emphasis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Fonctions de calcul sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline> avec le programme <fo:inline font-style="italic">bc</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Nous allons maintenant écrire les fonctions de calcul d’après les formules qui précèdent.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un point est représenté par un tableau et la convention du script est la suivante :</fo:block><fo:list-block id="idm45336282894288" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336282894032" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Le point à l’infini est codé par <fo:inline font-style="italic">point[2]</fo:inline> différent de zéro
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282892784" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Sinon (si <fo:inline font-style="italic">point[2]</fo:inline> est nul), <fo:inline font-style="italic">point[0]</fo:inline> est la coordonnée <fo:inline font-style="italic">x</fo:inline> et <fo:inline font-style="italic">point[1]</fo:inline> est la coordonnée <fo:inline font-style="italic">y</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le calcul de l’inverse modulaire utilise l'<fo:inline font-style="italic">algorithme d’Euclide étendu</fo:inline> <fo:basic-link internal-destination="22"><fo:inline>[22]</fo:inline></fo:basic-link>.</fo:block><fo:block id="idm45336282888560" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Note</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Ce script contient la fonction <fo:inline font-style="italic">powmod</fo:inline> utilisée précédemment, pour le RSA. Nous n’en avons pas besoin pour les calculs ECDSA.</fo:block></fo:block></fo:block><fo:block id="idm45336282887552" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">L’opérateur modulo</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">L’opérateur <fo:inline font-style="italic">%</fo:inline> (<fo:inline font-style="italic">modulo</fo:inline>) ne fonctionne pas à l’identique d’un langage à l’autre ou d’une librairie à l’autre.</fo:block><fo:list-block id="idm45336282885616" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336282885360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">bc</fo:inline> renvoie un nombre dont le signe est le signe du premier argument.
Ainsi <fo:inline font-style="italic">(-5) % 3</fo:inline> renvoie <fo:inline font-style="italic">-2</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282883280" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-style="italic">python</fo:inline> renvoie toujours une valeur positive. <fo:inline font-style="italic">(-5) % 3</fo:inline> renvoie <fo:inline font-style="italic">1</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282881360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La librairie <fo:inline font-style="italic">libgmp</fo:inline> (<fo:inline font-style="italic">GNU Multiple Precision Arithmetic Library</fo:inline>) renvoie toujours une valeur positive. <fo:inline font-style="italic">(-5) % 3</fo:inline> renvoie <fo:inline font-style="italic">1</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Cela ne change pas la nature des calculs effectués mais doit parfois être pris en compte. Ainsi la fonction <fo:inline font-style="italic">invmod</fo:inline> (définie dans <fo:inline font-style="italic">crypto.b</fo:inline> ci-dessous) ne peut pas fonctionner avec des nombres négatifs et elle commence par "normaliser" le premier argument pour qu’il soit compris entre <fo:inline font-style="italic">0</fo:inline> et <fo:inline font-style="italic">n - 1</fo:inline>.</fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">crypto.b. </fo:inline>
<fo:block id="idm45336282875728" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">        /* Calculate the invert of a modulo n */
define invmod(a, n) {
        auto aa, bb, r, t, anc_t, nou_t, negflag
        aa = n
        negflag = 0
        if (a &lt; 0) {
                negflag = 1
                a %= n
                if (a &lt; 0) a += n
        }
        bb = a
        r = 1
        t = 1
        anc_t = 0
        while (1) {
                q = aa / bb
                anc_r = r
                r = aa - bb * q

                nou_t = anc_t - q * t
                if (nou_t &gt;= 0) nou_t %= n
                if (nou_t &lt; 0) nou_t = n - (-nou_t % n)
                anc_t = t
                t = nou_t

                aa = bb
                bb = r
                if (r &lt;= 1) break;
        }

        if (r != 1) {
                        /*
                           No invert can be returned =&gt; error
                           Alternate solution: return -1

                           I find triggering an error best: the calculation stops
                           immediately instead of continuing with meaningless values
                        */
                return 1 % 0
        } else {
                if (negflag) t -= n
                return t
        }
}

/*
        The well-known powmod function, sometimes referred to in bc scripts
        as "mpower".
*/
define powmod(a, b, c) {
        auto p, r
        p = a
        r = 1
        while (b &gt; 0) {
                if (b % 2) r = (r * p) % c
                p = (p * p) % c
                b /= 2
        }
        return r
}

/*
        The EC functions below use the following conventions.

        - The point at infinity has non null element of index 2 (array[2]!=0),
          for any other point, array[2] is zero.

        - If array[2] is zero, array[0] is the x coordinate and
          array[1] is the y coordinate.

*/

/*
        ECC addition of p and q, p[0] being different from q[0]
*/
define void ec_add_core(*r[], p[], q[], m) {
        auto s
        s = ((p[1] - q[1]) * invmod(p[0] - q[0], m)) % m
        r[0] = (s^2 - p[0] - q[0]) % m
        r[1] = (s * (p[0] - r[0]) - p[1]) % m
        r[2] = 0
}

/*
   ECC point doubling
*/
define void ec_dbl_core(*r[], p[], a, m) {
        auto s
        s = ((3 * p[0]^2 + a) * invmod(2 * p[1], m)) % m
        r[0] = (s^2 - 2 * p[0]) % m
        r[1] = (s * (p[0] - r[0]) - p[1]) % m
        r[2] = 0
}

/*
        ECC addition of p and q for any value of p and q
*/
define void ec_add(*r[], p[], q[], a, m) {
        if (p[2]) { r[0] = q[0]; r[1] = q[1]; r[2] = q[2]; return }
        if (q[2]) { r[0] = p[0]; r[1] = p[1]; r[2] = p[2]; return }
        if (p[0] == q[0]) {
                if (p[1] != q[1]) {
                        r[2] = 1  /* We don't verify whether p[1]==-q[1] as it should... */
                } else {
                        if (p[2]) {
                                r[2] = 1
                                return
                        }
                        ec_dbl_core(r[], p[], a, m)
                }
        } else {
                ec_add_core(r[], p[], q[], m)
        }
}

/*
   ECC scalar point multiplication
*/
define void ec_mul(*r[], p[], k, a, m) {
        auto tmp[]
        r[2] = 1
        if (p[2]) return
        while (k &gt; 0) {
                if ((k % 2) == 1) {
                        ec_add(r[], r[], p[], a, m)
                }
                        /*
                         * ec_dbl(p[], p[], a, m) does not work with bc,
                         * need to use a temporary array.
                         */
                ec_add(tmp[], p[], p[], a, m)
                p[0]=tmp[0]
                p[1]=tmp[1]
                p[2]=tmp[2]
                k /= 2
        }
        if (!r[2]) {
                if (r[0] &lt; 0) r[0] += m
                if (r[1] &lt; 0) r[1] += m
        }
}</fo:block>
</fo:block><fo:block id="idm45336282867968" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" margin-left="0.25in" margin-right="0.25in"><fo:block keep-with-next.within-column="always" font-size="14pt" font-weight="bold" hyphenate="false">Optimisation et robustesse</fo:block><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Sur Internet on trouve des scripts qui appliquent la première formule (addition de deux points distincts) et la deuxième (doubler un point) sans vérifier les cas "P et Q alignés verticalement" ou "Point à l’infini".</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Dans la pratique ce n’est pas un souci car les nombres manipulés avec des clés x509 ne conduisent jamais à ces cas limites.
La fonction <fo:inline font-style="italic">ec_mul</fo:inline> pourrait ainsi être plus efficace, en appelant directement les fonctions ec_add_core et ec_dbl_core.</fo:block></fo:block></fo:block></fo:block><fo:block id="_repr&#xE9;sentation_d_8217_un_point_dans_le_standard_x509"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Représentation d’un point dans le standard x509</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Un point de la courbe d’abscisse <fo:inline font-style="italic">x</fo:inline> donnée ne peut avoir que deux valeurs de <fo:inline font-style="italic">y</fo:inline> (du fait du terme <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="super">2</fo:inline></fo:inline> des équations).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le standard X9.62 définit la méthode pour désigner quel <fo:inline font-style="italic">y</fo:inline> est le bon, en utilisant un seul bit d’information. Ainsi l’enregistrement de <fo:inline font-style="italic">x</fo:inline> et du bit d’information pour retrouver le bon <fo:inline font-style="italic">y</fo:inline> suffisent à coder un point, et cette forme est dite <fo:inline font-style="italic">compressée</fo:inline>. Comme il est en plus possible de mélanger les formes (compressée et non compressée), un point peut être codé de trois manières :</fo:block><fo:list-block id="idm45336282859344" provisional-distance-between-starts="24em * 0.60+1em" provisional-label-separation="1em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em"><fo:list-item id="idm45336282859088" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
La forme non compressée
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Enregistrement des deux coordonnées
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282857456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
La forme compressée
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Enregistrement de <fo:inline font-style="italic">x</fo:inline> et du bit d’information relatif à <fo:inline font-style="italic">y</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282855152" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()" text-align="start"><fo:block><fo:inline>
La forme hybride
</fo:inline></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Enregistrement de <fo:inline font-style="italic">x</fo:inline>, <fo:inline font-style="italic">y</fo:inline> et du bit d’information relatif à <fo:inline font-style="italic">y</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline> on a <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="sub">1</fo:inline> = -y<fo:inline font-size="75%" baseline-shift="sub">2</fo:inline></fo:inline> (car non seulement <fo:inline font-style="italic">y</fo:inline> y apparaît sous la forme <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="super">2</fo:inline></fo:inline>, mais en plus, il est isolé à gauche du signe <fo:inline font-style="italic">égal</fo:inline>) et comme nous sommes dans l’arithmétique modulaire on peut ré-écrire cette égalité <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="sub">1</fo:inline> + y<fo:inline font-size="75%" baseline-shift="sub">2</fo:inline> = p</fo:inline>.
<fo:inline font-style="italic">p</fo:inline> étant impair, <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="sub">1</fo:inline></fo:inline> et <fo:inline font-style="italic">y<fo:inline font-size="75%" baseline-shift="sub">2</fo:inline></fo:inline> n’ont pas même parité. Le bit d’information est le dernier bit de <fo:inline font-style="italic">y</fo:inline> (sa parité). On comprend aisément que la forme hybride ne présente aucun intérêt sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">p</fo:inline></fo:inline>, puisqu’un simple examen de <fo:inline font-style="italic">y</fo:inline> donne le bit d’information à employer dans la forme compressée. La forme hybride apporte un plus sur <fo:inline font-style="italic">F<fo:inline font-size="75%" baseline-shift="sub">2<fo:inline font-size="75%" baseline-shift="super">m</fo:inline></fo:inline></fo:inline> où le bit d’information doit être calculé.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Le standard x509 (ici la RFC 5480) permet de coder un point soit sous forme compressée, soit sous forme non compressée. La RFC 5480 interdit expressément la forme hybride définie par le standard X9.62.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Selon le standard X9.62 en vigueur dans la RFC 5480 (nous ne mentionnons donc pas ici la forme hybride, interdite par la RFC 5480) les formes compressée et non compressée sont codées ainsi<fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">15</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">15</fo:inline>Le standard X9.62 définit <fo:inline font-style="italic">00</fo:inline> comme seul octet pour coder le point à l’infini. La RFC 5480 interdit toute autre valeur que <fo:inline font-style="italic">02</fo:inline>, <fo:inline font-style="italic">03</fo:inline> et <fo:inline font-style="italic">04</fo:inline>, et interdit donc <fo:inline font-style="italic">00</fo:inline>. C’est logique car on ne voit pas dans quel but le point à l’infini serait enregistré dans le cadre x509. Dans le standard x509, un point est une clé publique.</fo:block></fo:footnote-body></fo:footnote> :</fo:block><fo:list-block id="idm45336282837712" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336282837456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Premier octet = <fo:inline font-style="italic">02</fo:inline> : le point est compressé, et <fo:inline font-style="italic">y</fo:inline> est pair. <fo:inline font-style="italic">x</fo:inline> est codé juste après 02.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282835456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Premier octet = <fo:inline font-style="italic">03</fo:inline> : le point est compressé, et <fo:inline font-style="italic">y</fo:inline> est impair. <fo:inline font-style="italic">x</fo:inline> est codé juste après 03.
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282833456" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Premier octet = <fo:inline font-style="italic">04</fo:inline> : le point est non compressé. <fo:inline font-style="italic">x</fo:inline> est codé juste après 04, et <fo:inline font-style="italic">y</fo:inline> est codé juste après <fo:inline font-style="italic">x</fo:inline>. Comme <fo:inline font-style="italic">x</fo:inline> et <fo:inline font-style="italic">y</fo:inline> ont même taille, il n’y a pas besoin de délimiteur pour retrouver la position à laquelle on passe de <fo:inline font-style="italic">x</fo:inline> à <fo:inline font-style="italic">y</fo:inline>.
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="_la_courbe_prime256v1_secp256r1"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">La courbe prime256v1 (secp256r1)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Les paramètres de la courbe prime256v1. </fo:inline>Récupérons les paramètres (depuis <fo:inline font-style="italic">openssl</fo:inline> ou depuis ce document <fo:basic-link internal-destination="18"><fo:inline>[18]</fo:inline></fo:basic-link>) de la courbe et enregistrons-les dans le fichier <fo:inline font-style="italic">secp256r1.b</fo:inline>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Pour représenter un point de la courbe nous utilisons la convention <fo:inline font-style="italic">point[0] = abscisse du point</fo:inline> et <fo:inline font-style="italic">point[1] = ordonnée du point</fo:inline>. Le point à l’infini est représenté par <fo:inline font-style="italic">point[2] = 1</fo:inline> (<fo:inline font-style="italic">point[2] = 0</fo:inline> pour tout autre point).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">secp256r1.b. </fo:inline>
<fo:block id="idm45336282822944" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">save_ibase=ibase
ibase=2^4
p=FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF
a=FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC
b=5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B
g[0]=6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296
g[1]=4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5
g[2]=0
n=FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551
h=1
ibase=save_ibase</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Au passage, on peut vérifier que le point <fo:inline font-style="italic">G</fo:inline> fait bien partie de la courbe :</fo:block><fo:block id="idm45336282820128" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 32.  </fo:block><fo:block id="idm45336282819376"><fo:external-graphic src="url(./images/img-verif-prime256v1-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">On peut également vérifier que <fo:inline font-style="italic">nG = O</fo:inline>, <fo:inline font-style="italic">O</fo:inline> étant le point à l’infini.
Dans la convention des fonctions de <fo:inline font-style="italic">crypto.b</fo:inline>, le point à l’infini est codé par une valeur non nulle de l'élément d’indice <fo:inline font-style="italic">2</fo:inline> :</fo:block><fo:block id="idm45336282815184" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 33.  </fo:block><fo:block id="idm45336282814432"><fo:external-graphic src="url(./images/img-n_fois_g-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Création d’une paire de clé privée et publique sur prime256v1. </fo:inline>Exécuter <fo:footnote><fo:inline><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">16</fo:inline></fo:inline><fo:footnote-body font-family="serif,Symbol,ZapfDingbats" font-size="8pt" font-weight="normal" font-style="normal" text-align="justify" start-indent="0pt" end-indent="0pt" text-indent="0pt" hyphenate="true" wrap-option="wrap" linefeed-treatment="treat-as-space"><fo:block><fo:inline font-family="serif,Symbol,ZapfDingbats" font-size="75%" font-weight="normal" font-style="normal" baseline-shift="super">16</fo:inline>Enregistrer une clé privée dans un fichier non protégé par mot de passe (chiffré) est une mauvaise pratique. Ici cela n’a pas d’importance puisque la clé est une clé de test.</fo:block></fo:footnote-body></fo:footnote></fo:block><fo:block id="idm45336282811008" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl ecparam -name prime256v1 -genkey -out k.pem</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Examiner le résultat avec</fo:block><fo:block id="idm45336282809760" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">$ openssl ec -in k.pem -noout -text</fo:block><fo:block id="idm45336282808896" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 34.  </fo:block><fo:block id="idm45336282808144"><fo:external-graphic src="url(./images/img-key-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Par défaut, <fo:inline font-style="italic">openssl</fo:inline> enregistre les clés publiques sous forme non compressée, ce que l’on peut voir au <fo:inline font-style="italic">04</fo:inline> qui démarre la suite d’octets en-dessous de "pub:".</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">À l’aide de la commande <fo:inline font-style="italic">openssl</fo:inline> ci-dessus (ou bien avec <fo:inline font-style="italic">pkfile</fo:inline>, ou encore <fo:inline font-style="italic">dder</fo:inline>), copier/coller les valeurs de la clé privée et publique dans <fo:inline font-style="italic">k.b</fo:inline>, sous les noms <fo:inline font-style="italic">k</fo:inline> et <fo:inline font-style="italic">q[]</fo:inline>, respectivement.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">k.b. </fo:inline>
<fo:block id="idm45336282801200" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">save_ibase=ibase
ibase=2^4
k=673DCAD121E37B7E15AC792F8CA0670856E2DE9C233684A9A0FA3D767B61FBF1
q[0]=134D4E5F632E0545350FB89EE05200450E07A5B115BCA72DF5F4896D2433A65A
q[1]=A1A33A97ACB4E40D0519CB029B1E85E26D3D6B3D7FF3D3626127D0C045392D91
q[2]=0
ibase=save_ibase</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-weight="bold" keep-with-next.within-line="always" padding-end="1em">Calcul de la clé publique d’après la clé privée. </fo:inline>On peut facilement calculer <fo:inline font-style="italic">Q</fo:inline> (la clé publique) d’après <fo:inline font-style="italic">k</fo:inline> (la clé privée). Au passage, cela permet de vérifier le bon fonctionnement de la chaîne :</fo:block><fo:list-block id="idm45336282797616" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45336282796640" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les fonctions de <fo:inline font-style="italic">crypto.b</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282795488" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
Les paramètres de domaine de <fo:inline font-style="italic">prime256v1</fo:inline>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282794256" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
La définition dans <fo:inline font-style="italic">k.b</fo:inline> des valeurs de la paire de clés privée et publique
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block><fo:block id="idm45336282792848" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure 35.  </fo:block><fo:block id="idm45336282792096"><fo:external-graphic src="url(./images/img-k_fois_g-redim.png)" width="auto" height="auto" content-width="auto" content-height="auto"/></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="_bibliography" space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em"><fo:block><fo:block><fo:block margin-left="0pt" font-size="24.8832pt" font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Bibliography</fo:block></fo:block></fo:block></fo:block></fo:block><fo:list-block id="idm45336282788928" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45336282788672" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="1"/>[1]</fo:inline> Présentation de l’ASN.1 : <fo:basic-link external-destination="url(http://www.itu.int/en/ITU-T/asn1/Pages/introduction.aspx)"><fo:inline hyphenate="false">http://www.itu.int/en/ITU-T/asn1/Pages/introduction.aspx</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282785888" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="2"/>[2]</fo:inline> Document X.690 (format PDF) : <fo:basic-link external-destination="url(https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf)"><fo:inline hyphenate="false">https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282783024" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="3"/>[3]</fo:inline> Article Wikipédia consacré au X.690 : <fo:basic-link external-destination="url(https://en.wikipedia.org/wiki/X.690)"><fo:inline hyphenate="false">https://en.wikipedia.org/wiki/X.690</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282780304" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="4"/>[4]</fo:inline> RFC 5280 (certificats x509 v3) : <fo:basic-link external-destination="url(https://tools.ietf.org/html/rfc5280)"><fo:inline hyphenate="false">https://tools.ietf.org/html/rfc5280</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282777600" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="5"/>[5]</fo:inline> Article Wikipédia consacré au RSA : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Chiffrement_RSA)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Chiffrement_RSA</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282774880" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="6"/>[6]</fo:inline> Page d’accueil de <fo:inline font-style="italic">bc</fo:inline> : <fo:basic-link external-destination="url(https://www.gnu.org/software/bc/)"><fo:inline hyphenate="false">https://www.gnu.org/software/bc/</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282771872" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="7"/>[7]</fo:inline> <fo:inline font-style="italic">bc</fo:inline> pour Windows : <fo:basic-link external-destination="url(http://gnuwin32.sourceforge.net/packages/bc.htm)"><fo:inline hyphenate="false">http://gnuwin32.sourceforge.net/packages/bc.htm</fo:inline></fo:basic-link>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:inline font-style="italic">bc</fo:inline> a besoin du fichier <fo:inline font-style="italic">readline5.dll</fo:inline> pour s’exécuter. Vous pouvez le trouver à cette URL : <fo:basic-link external-destination="url(http://gnuwin32.sourceforge.net/packages/readline.htm)"><fo:inline hyphenate="false">http://gnuwin32.sourceforge.net/packages/readline.htm</fo:inline></fo:basic-link></fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282767200" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="8"/>[8]</fo:inline> Le site de notepad++  : <fo:basic-link external-destination="url(https://notepad-plus-plus.org/fr)"><fo:inline hyphenate="false">https://notepad-plus-plus.org/fr</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282764576" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="9"/>[9]</fo:inline> Article Wikipédia sur l’algorithme d’exponentiation rapide : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Exponentiation_rapide)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Exponentiation_rapide</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282761792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="10"/>[10]</fo:inline> Article Wikipédia sur l’exponentiation modulaire : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Exponentiation_modulaire)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Exponentiation_modulaire</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282759008" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="11"/>[11]</fo:inline> Obtenir <fo:inline font-style="italic">dder</fo:inline> : <fo:basic-link external-destination="url(http://dder.sourceforge.net)"><fo:inline hyphenate="false">http://dder.sourceforge.net</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282756000" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="12"/>[12]</fo:inline> Obtenir <fo:inline font-style="italic">pkfile</fo:inline> : <fo:basic-link external-destination="url(http://pkfile.sourceforge.net)"><fo:inline hyphenate="false">http://pkfile.sourceforge.net</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282752992" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="13"/>[13]</fo:inline> GNUWin32 : <fo:basic-link external-destination="url(http://gnuwin32.sourceforge.net/packages/openssl.htm)"><fo:inline hyphenate="false">http://gnuwin32.sourceforge.net/packages/openssl.htm</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282750368" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="14"/>[14]</fo:inline> Télécharger 7-ZIP : <fo:basic-link external-destination="url(http://www.7-zip.org/download.html)"><fo:inline hyphenate="false">http://www.7-zip.org/download.html</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282747744" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="15"/>[15]</fo:inline> Peter Seibt, Andreea Dragut Cours de cryptographie Chapitre V (format PDF) : <fo:basic-link external-destination="url(http://www.dil.univ-mrs.fr/~jfp/master/m03/CompresChap5AES.pdf)"><fo:inline hyphenate="false">http://www.dil.univ-mrs.fr/~jfp/master/m03/CompresChap5AES.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282744784" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="16"/>[16]</fo:inline> An introduction to elliptic curve cryptography : <fo:basic-link external-destination="url(http://www.embedded.com/design/safety-and-security/4396040/An-Introduction-to-Elliptic-Curve-Cryptography)"><fo:inline hyphenate="false">http://www.embedded.com/design/safety-and-security/4396040/An-Introduction-to-Elliptic-Curve-Cryptography</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282741792" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="17"/>[17]</fo:inline> Corps finis (format PDF) : <fo:basic-link external-destination="url(http://iml.univ-mrs.fr/~rodier/Cours/RappelCorps%20finis.pdf)"><fo:inline hyphenate="false">http://iml.univ-mrs.fr/~rodier/Cours/RappelCorps%20finis.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282739008" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="18"/>[18]</fo:inline> SEC 2: Recommended Elliptic Curve Domain Parameters (format PDF) : <fo:basic-link external-destination="url(http://www.secg.org/SEC2-Ver-1.0.pdf)"><fo:inline hyphenate="false">http://www.secg.org/SEC2-Ver-1.0.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282736240" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="19"/>[19]</fo:inline> RECOMMENDED ELLIPTIC CURVES FOR FEDERAL GOVERNMENT USE (format PDF) : <fo:basic-link external-destination="url(http://csrc.nist.gov/groups/ST/toolkit/documents/dss/NISTReCur.pdf)"><fo:inline hyphenate="false">http://csrc.nist.gov/groups/ST/toolkit/documents/dss/NISTReCur.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282733296" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="20"/>[20]</fo:inline> Elliptic Curve Cryptography Subject Public Key Information : <fo:basic-link external-destination="url(https://tools.ietf.org/html/rfc5480)"><fo:inline hyphenate="false">https://tools.ietf.org/html/rfc5480</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282730528" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="21"/>[21]</fo:inline> "Courbe elliptique" sur Wikipédia : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Courbe_elliptique#Additionner_les_points_:_d.C3.A9finition_par_la_m.C3.A9thode_des_tangentes_et_des_s.C3.A9cantes)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Courbe_elliptique#Additionner_les_points_:_d.C3.A9finition_par_la_m.C3.A9thode_des_tangentes_et_des_s.C3.A9cantes</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282727504" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="22"/>[22]</fo:inline> Article Wikipédia sur l’inverse modulaire : <fo:basic-link external-destination="url(https://fr.wikipedia.org/wiki/Inverse_modulaire)"><fo:inline hyphenate="false">https://fr.wikipedia.org/wiki/Inverse_modulaire</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282724880" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="23"/>[23]</fo:inline> Conception d’algorithmes et applications (LI325) COURS 10 (format PDF) : <fo:basic-link external-destination="url(http://www.di.ens.fr/~busic/cours/LI325/coursCAAC10.pdf)"><fo:inline hyphenate="false">http://www.di.ens.fr/~busic/cours/LI325/coursCAAC10.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282722064" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="99"/>[99]</fo:inline> ECC Tutorial (en anglais) : <fo:basic-link external-destination="url(http://www.johannes-bauer.com/compsci/ecc)"><fo:inline hyphenate="false">http://www.johannes-bauer.com/compsci/ecc</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45336282719360" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>•</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block>
<fo:inline font-weight="bold"><fo:inline id="98"/>[98]</fo:inline> Paramètres de domain brainpool (format PDF) : <fo:basic-link external-destination="url(http://www.ecc-brainpool.org/download/Domain-parameters.pdf)"><fo:inline hyphenate="false">http://www.ecc-brainpool.org/download/Domain-parameters.pdf</fo:inline></fo:basic-link>
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:flow></fo:page-sequence></fo:root>